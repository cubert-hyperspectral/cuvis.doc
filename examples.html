

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; Cuvis SDK 3.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=eb155f5e"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/tabs.js?v=3030b3cb"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cuvis C API" href="cwrapper.html" />
    <link rel="prev" title="v3.3.0" href="releasehistory.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Cuvis SDK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdkuserguide.html">SDK User’s Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-a-measurment">Loading a Measurment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reprocessing-a-measurement">Reprocessing a Measurement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exporting-a-measurement">Exporting a Measurement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#changing-the-distance-of-a-measurement">Changing the Distance of a Measurement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recording-single-measurements">Recording single Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recording-a-video">Recording a video</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rerecording-a-video-from-already-recorded-data">Rerecording a video from already recorded data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cwrapper.html">Cuvis C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cppwrapper.html">Cuvis C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythonwrapper.html">Cuvis Python API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cuvis SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h1>
<section id="loading-a-measurment">
<h2>Loading a Measurment<a class="headerlink" href="#loading-a-measurment" title="Link to this heading"></a></h2>
<p>This example demonstrates how to load and process hyperspectral measurement data using the cuvis SDK.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-0-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-0-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-0-Qw==" class="sphinx-tabs-panel group-tab" id="panel-0-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;assert.h&gt;</span>
<span class="c1">#include &lt;stdint.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;sessionfile (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sess</span><span class="p">;</span>
  <span class="n">CUVIS_MESU</span> <span class="n">mesu1</span><span class="p">;</span>
  <span class="n">unsigned</span> <span class="n">chn</span><span class="p">;</span>

  <span class="n">unsigned</span> <span class="n">x</span><span class="p">;</span>
  <span class="n">unsigned</span> <span class="n">y</span><span class="p">;</span>

  <span class="n">const</span> <span class="n">uint16_t</span><span class="o">*</span> <span class="n">cube16bit</span><span class="p">;</span>
  <span class="o">//</span><span class="n">const</span> <span class="n">uint16_t</span><span class="o">*</span> <span class="n">info_ptr</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 01 load measurement</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">User Settings Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">sessionfile (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">loading user settings...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading session...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sess</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading measurement...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span>
      <span class="n">sess</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu1</span><span class="p">));</span>

  <span class="n">CUVIS_MESU_METADATA</span> <span class="n">mesu_data</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
  <span class="n">printf</span><span class="p">(</span>
      <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>

  <span class="k">assert</span><span class="p">(</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">==</span> <span class="n">Cube_Raw</span> <span class="o">&amp;&amp;</span>
      <span class="s2">&quot;This example requires raw mode&quot;</span><span class="p">);</span>

  <span class="n">CUVIS_IMBUFFER</span> <span class="n">cube</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span>
      <span class="n">cuvis_measurement_get_data_image</span><span class="p">(</span><span class="n">mesu1</span><span class="p">,</span> <span class="n">CUVIS_MESU_CUBE_KEY</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cube</span><span class="p">));</span>
  <span class="n">CUVIS_IMBUFFER</span> <span class="n">iminfo</span><span class="p">;</span>
  <span class="n">cuvis_measurement_get_data_image</span><span class="p">(</span><span class="n">mesu1</span><span class="p">,</span> <span class="n">CUVIS_MESU_CUBE_INFO_KEY</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iminfo</span><span class="p">);</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span> <span class="o">&amp;</span> <span class="n">CUVIS_MESU_FLAG_OVERILLUMINATED</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;-- is overilluminated --</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;-- is NOT overilluminated --</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span> <span class="o">&amp;</span> <span class="n">CUVIS_MESU_FLAG_POOR_REFERENCE</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;-- has poor reference --</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;-- has GOOD reference --</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;INFO cube No of channels: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iminfo</span><span class="o">.</span><span class="n">channels</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;INFO cube width: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iminfo</span><span class="o">.</span><span class="n">width</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;INFO cube height: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iminfo</span><span class="o">.</span><span class="n">height</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;DATA cube width: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;DATA cube height: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">height</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;INFO cube type: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iminfo</span><span class="o">.</span><span class="n">format</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;INFO cube bytes: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iminfo</span><span class="o">.</span><span class="n">bytes</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;DATA cube type: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">format</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;DATA cube bytes: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">bytes</span><span class="p">);</span>

  <span class="k">assert</span><span class="p">(</span>
      <span class="n">cube</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">imbuffer_format_uint16</span> <span class="o">&amp;&amp;</span>
      <span class="s2">&quot;16 bit cube required for this example&quot;</span><span class="p">);</span>

  <span class="o">//</span><span class="n">reinterpret</span> <span class="k">as</span> <span class="n">uint16</span>
  <span class="n">cube16bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span> <span class="n">uint16_t</span><span class="o">*</span><span class="p">)(</span><span class="n">cube</span><span class="o">.</span><span class="n">raw</span><span class="p">);</span>
  <span class="o">//</span><span class="n">info_ptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span> <span class="n">uint16_t</span><span class="o">*</span><span class="p">)(</span><span class="n">iminfo</span><span class="o">.</span><span class="n">raw</span><span class="p">);</span>

  <span class="n">x</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
  <span class="n">y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

  <span class="k">assert</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;x index exceeds cube width&quot;</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">height</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;x index exceeds cube width&quot;</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;lambda [nm]; raw counts [au]; pixel info </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">chn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">chn</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">channels</span><span class="p">;</span> <span class="n">chn</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="o">//</span> <span class="n">memory</span> <span class="n">layout</span><span class="p">:</span>
    <span class="o">//</span><span class="n">unsigned</span> <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">channels</span> <span class="o">+</span> <span class="n">chn</span><span class="p">;</span>
    <span class="o">//</span><span class="n">uint16_t</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cube16bit</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

    <span class="n">uint16_t</span> <span class="n">value</span> <span class="o">=</span> <span class="n">IMBUFFER_GET</span><span class="p">(</span><span class="n">cube16bit</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">chn</span><span class="p">,</span> <span class="n">cube</span><span class="p">);</span>
    <span class="o">//</span><span class="n">only</span> <span class="n">works</span> <span class="k">with</span> <span class="n">v3</span><span class="o">.</span><span class="n">X</span> <span class="n">CUVIS</span> <span class="n">data</span>
    <span class="o">//</span><span class="n">auto</span> <span class="n">pixel_info</span> <span class="o">=</span> <span class="n">IMBUFFER_GET</span><span class="p">(</span><span class="n">info_ptr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">iminfo</span><span class="p">);</span>
    <span class="n">unsigned</span> <span class="k">lambda</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">wavelength</span><span class="p">[</span><span class="n">chn</span><span class="p">];</span>

    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">; </span><span class="si">%d</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="o">//</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">; </span><span class="si">%d</span><span class="s2">; </span><span class="si">%d</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">,</span>
        <span class="n">value</span>
        <span class="o">//</span><span class="n">pixel_info</span><span class="p">);</span>
    <span class="p">);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>

  <span class="o">//</span><span class="k">for</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span>
  <span class="o">//</span><span class="p">{</span>
  <span class="o">//</span>  <span class="k">for</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">height</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span>
  <span class="o">//</span>  <span class="p">{</span>
  <span class="o">//</span> <span class="n">memory</span> <span class="n">layout</span><span class="p">:</span>
  <span class="o">//</span><span class="n">unsigned</span> <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">channels</span> <span class="o">+</span> <span class="n">chn</span><span class="p">;</span>
  <span class="o">//</span><span class="n">uint16_t</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cube16bit</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

  <span class="o">//</span><span class="n">auto</span> <span class="n">pixel_info</span> <span class="o">=</span> <span class="n">IMBUFFER_GET</span><span class="p">(</span><span class="n">info_ptr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">iminfo</span><span class="p">);</span>

  <span class="o">//</span><span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">; &quot;</span><span class="p">,</span> <span class="n">pixel_info</span><span class="p">);</span>
  <span class="o">//</span>  <span class="p">}</span>
  <span class="o">//</span>  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="o">//</span><span class="p">}</span>

  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mesu1</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sess</span><span class="p">);</span>
  <span class="n">cuvis_shutdown</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;finished.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.hpp&quot;</span>

<span class="c1">#include &lt;cassert&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>

<span class="o">//</span><span class="c1">#include &lt;opencv/opencv.hpp&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Too few Arguments! Please provide:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user settings directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Example 01 load measurement cpp &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;User Settings Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">userSettingsDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sessionLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading user settings...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading session... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sess</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading measurement... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">auto</span> <span class="n">optmesu</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optmesu</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">optmesu</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Data 1&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;t=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">integration_time</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; ms &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;mode=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">processing_mode</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">measurement_flags</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  Flags&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">auto</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">flags</span> <span class="p">:</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">measurement_flags</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  - &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">flags</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; (&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">flags</span><span class="o">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;)&quot;</span>
                <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">assert</span><span class="p">(</span>
      <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">processing_mode</span> <span class="o">==</span> <span class="n">Cube_Raw</span> <span class="o">&amp;&amp;</span>
      <span class="s2">&quot;This example requires raw mode&quot;</span><span class="p">);</span>

  <span class="n">auto</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">cube_it</span> <span class="o">=</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_imdata</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">find</span><span class="p">(</span><span class="n">CUVIS_MESU_CUBE_KEY</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">cube_it</span> <span class="o">!=</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_imdata</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;Cube not found&quot;</span><span class="p">);</span>

  <span class="n">auto</span> <span class="n">cube</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">get</span><span class="o">&lt;</span><span class="n">cuvis</span><span class="p">::</span><span class="n">image_t</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">uint16_t</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">cube_it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">);</span>

  <span class="o">//</span><span class="n">uncomment</span> <span class="n">to</span> <span class="n">show</span> <span class="n">a</span> <span class="n">single</span> <span class="n">channel</span> <span class="k">with</span> <span class="n">openCV</span>
  <span class="o">/*</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">Mat</span> <span class="n">img</span><span class="p">(</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">Size</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">_height</span><span class="p">),</span>
    <span class="n">CV_16UC</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">_channels</span><span class="p">),</span>
    <span class="n">const_cast</span><span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">reinterpret_cast</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">void</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">_data</span><span class="p">)),</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">Mat</span><span class="p">::</span><span class="n">AUTO_STEP</span><span class="p">);</span>

    <span class="n">cv</span><span class="p">::</span><span class="n">Mat</span> <span class="n">singleChannel</span><span class="p">;</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">extractChannel</span><span class="p">(</span>
        <span class="n">img</span><span class="p">,</span> <span class="n">singleChannel</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span> <span class="o">//</span> <span class="n">extract</span> <span class="n">channel</span> <span class="mi">25</span> <span class="k">as</span> <span class="n">an</span> <span class="n">example</span>
    <span class="n">singleChannel</span><span class="o">.</span><span class="n">convertTo</span><span class="p">(</span><span class="n">singleChannel</span><span class="p">,</span> <span class="n">CV_8U</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">16.0</span><span class="p">);</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">imshow</span><span class="p">(</span><span class="s2">&quot;channel 25&quot;</span><span class="p">,</span> <span class="n">singleChannel</span><span class="p">);</span>
    <span class="n">cv</span><span class="p">::</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="o">*/</span>

  <span class="n">std</span><span class="p">::</span><span class="n">size_t</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">size_t</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

  <span class="k">assert</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">_width</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;x index exceeds cube width&quot;</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">_height</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;y index exceeds cube height&quot;</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;lambda [nm]; raw counts [au] &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">size_t</span> <span class="n">chn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">chn</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">_channels</span><span class="p">;</span> <span class="n">chn</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="o">//</span> <span class="n">memory</span> <span class="n">layout</span><span class="p">:</span>
    <span class="o">//</span><span class="n">unsigned</span> <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">channels</span> <span class="o">+</span> <span class="n">chn</span><span class="p">;</span>
    <span class="o">//</span><span class="n">uint16_t</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cube16bit</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

    <span class="n">auto</span> <span class="n">const</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">chn</span><span class="p">);</span>
    <span class="n">unsigned</span> <span class="k">lambda</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">_wavelength</span><span class="p">[</span><span class="n">chn</span><span class="p">];</span>

    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="k">lambda</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">shutdown</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;finished. &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_loadMeasurement</span><span class="p">(</span>
        <span class="n">userSettingsDir</span><span class="p">,</span>
        <span class="n">measurementLoc</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading session...&quot;</span><span class="p">)</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading measurement file...&quot;</span><span class="p">)</span>
    <span class="n">mesu</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">mesu</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data 1 </span><span class="si">{}</span><span class="s2"> t=</span><span class="si">{}</span><span class="s2">ms mode=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">processing_mode</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">,</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">MeasurementFlags</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flags: </span><span class="si">{</span><span class="n">mesu</span><span class="o">.</span><span class="n">measurement_flags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">MeasurementFlags</span><span class="o">.</span><span class="n">supremum</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">mesu</span><span class="o">.</span><span class="n">measurement_flags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">cube</span> <span class="o">=</span> <span class="n">mesu</span><span class="o">.</span><span class="n">cube</span>
    <span class="k">if</span> <span class="n">cube</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cube not found&quot;</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="mi">120</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">200</span>

    <span class="k">assert</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="s2">&quot;x index exceeds cube width!&quot;</span>
    <span class="k">assert</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">cube</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="s2">&quot;y index exceeds cube height!&quot;</span>

    <span class="n">lambda_wl</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">raw_counts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">chn</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">channels</span><span class="p">):</span>
        <span class="n">lambda_wl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">wavelength</span><span class="p">[</span><span class="n">chn</span><span class="p">])</span>
        <span class="n">raw_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">chn</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_wl</span><span class="p">,</span> <span class="n">raw_counts</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;lambda [nm]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;raw counts [au]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Spectrum of </span><span class="si">{}</span><span class="s2"> for x=</span><span class="si">{}</span><span class="s2">, y=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">))</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default image</span>
    <span class="n">loc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single.cu3s&quot;</span>

    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 01: Load Measurement. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">measurementLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Measurement file (.cu3s) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">measurementLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">loc_file</span>

    <span class="n">run_example_loadMeasurement</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">))</span>
</pre></div>
</div>
</div></div>
</section>
<section id="reprocessing-a-measurement">
<h2>Reprocessing a Measurement<a class="headerlink" href="#reprocessing-a-measurement" title="Link to this heading"></a></h2>
<p>This example demonstrates the process of reprocessing hyperspectral measurement data using the cuvis SDK.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-1-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-1-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-1-Qw==" class="sphinx-tabs-panel group-tab" id="panel-1-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;stdio.h&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;measurement file (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;dark file (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;white file (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;distance file (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Name of output directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">darkLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">whiteLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">distanceLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">outDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 02 reprocess measurement </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user Settings Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">measurement file (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">dark file (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">darkLoc</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">white file (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">whiteLoc</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">distance file (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">distanceLoc</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">output Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">outDir</span><span class="p">);</span>

  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sessMesu</span><span class="p">;</span>
  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sessDark</span><span class="p">;</span>
  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sessWhite</span><span class="p">;</span>
  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sessDistance</span><span class="p">;</span>

  <span class="n">CUVIS_MESU</span> <span class="n">mesu</span><span class="p">;</span>
  <span class="n">CUVIS_MESU_METADATA</span> <span class="n">mesu_data</span><span class="p">;</span>
  <span class="n">CUVIS_MESU</span> <span class="n">dark</span><span class="p">;</span>
  <span class="n">CUVIS_MESU</span> <span class="n">white</span><span class="p">;</span>
  <span class="n">CUVIS_MESU</span> <span class="n">distance</span><span class="p">;</span>

  <span class="n">CUVIS_PROC_CONT</span> <span class="n">procCont</span><span class="p">;</span>

  <span class="n">CUVIS_INT</span> <span class="n">is_capable</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">loading settings... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading sessionfiles... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sessMesu</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">darkLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sessDark</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">whiteLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sessWhite</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">distanceLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sessDistance</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading measurement... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span><span class="n">sessMesu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span><span class="n">sessDark</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dark</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span><span class="n">sessWhite</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">white</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span><span class="n">sessDistance</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">distance</span><span class="p">));</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
  <span class="n">printf</span><span class="p">(</span>
      <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Load processing context...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_create_from_session_file</span><span class="p">(</span><span class="n">sessMesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">procCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Set references ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_reference</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">dark</span><span class="p">,</span> <span class="n">Reference_Dark</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_reference</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">white</span><span class="p">,</span> <span class="n">Reference_White</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_reference</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">Reference_Distance</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Prepare processing and export ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_PROC_ARGS</span> <span class="n">args</span><span class="p">;</span>
  <span class="n">args</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Raw</span><span class="p">;</span>
  <span class="n">args</span><span class="o">.</span><span class="n">allow_recalib</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_is_capable</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_capable</span><span class="p">));</span>

  <span class="n">CUVIS_EXPORT_GENERAL_SETTINGS</span> <span class="n">general_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">initializer</span> <span class="nb">list</span> <span class="n">only</span> <span class="n">takes</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="n">leave</span> <span class="n">empty</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">afterwards</span><span class="o">.</span>
    <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">pan_sharpening_interpolation_type_NearestNeighbor</span><span class="p">,</span>
    <span class="n">pan_sharpening_algorithm_Noop</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">};</span>

  <span class="n">CUVIS_EXPORT_CUBE_SETTINGS</span> <span class="n">cube_settings</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_fragmentation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">OperationMode_Internal</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_info_file</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">is_capable</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;reprocess measurement to Cube_Raw mode...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">args</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_apply</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">char</span> <span class="n">exportDirRAW</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirRAW</span><span class="p">,</span> <span class="n">outDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirRAW</span><span class="p">,</span> <span class="s2">&quot;/RAW&quot;</span><span class="p">);</span>

    <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">exportDirRAW</span><span class="p">);</span>
    <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span>
        <span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_apply</span><span class="p">(</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Cannot process to Cube_Raw mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">args</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_DarkSubtract</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_is_capable</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_capable</span><span class="p">));</span>

  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">is_capable</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;reprocess measurement to Cube_DarkSubtract mode...&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">args</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_apply</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">char</span> <span class="n">exportDirDS</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirDS</span><span class="p">,</span> <span class="n">outDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirDS</span><span class="p">,</span> <span class="s2">&quot;/DS&quot;</span><span class="p">);</span>

    <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">exportDirDS</span><span class="p">);</span>
    <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span>
        <span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_apply</span><span class="p">(</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Cannot process to Cube_DarkSubtract mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">args</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Reflectance</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_is_capable</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_capable</span><span class="p">));</span>

  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">is_capable</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;reprocess measurement to Cube_Reflectance mode...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">args</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_apply</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">char</span> <span class="n">exportDirREF</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirREF</span><span class="p">,</span> <span class="n">outDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirREF</span><span class="p">,</span> <span class="s2">&quot;/REF&quot;</span><span class="p">);</span>

    <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">exportDirREF</span><span class="p">);</span>
    <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span>
        <span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_apply</span><span class="p">(</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Cannot process to Cube_Reflectance mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">args</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_SpectralRadiance</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_is_capable</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_capable</span><span class="p">));</span>

  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">is_capable</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;reprocess measurement to Cube_SpectralRadiance mode...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">args</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_apply</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">char</span> <span class="n">exportDirSPRAD</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirSPRAD</span><span class="p">,</span> <span class="n">outDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirSPRAD</span><span class="p">,</span> <span class="s2">&quot;/SPRAD&quot;</span><span class="p">);</span>

    <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">exportDirSPRAD</span><span class="p">);</span>
    <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span>
        <span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_apply</span><span class="p">(</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Cannot process to Cube_SpectralRadiance mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">cuvis_proc_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mesu</span><span class="p">);</span>
  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dark</span><span class="p">);</span>
  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">white</span><span class="p">);</span>
  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">distance</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sessMesu</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sessDark</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sessWhite</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sessDistance</span><span class="p">);</span>
  <span class="n">cuvis_shutdown</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.hpp&quot;</span>

<span class="c1">#include &lt;cassert&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Too few Arguments! Please provide:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user settings directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;measurement file (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;dark file (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;white file (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;distance file (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Name of output directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">darkLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">whiteLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">distanceLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">outDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Example 02 reprocess measurement cpp &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;User Settings Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">userSettingsDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;measurement file (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">measurementLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;dark file (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">darkLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;white file (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">whiteLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;distance file (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">distanceLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;output Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">outDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading settings... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading measurement... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sessMesu</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">);</span>
  <span class="n">auto</span> <span class="n">optMesu</span> <span class="o">=</span> <span class="n">sessMesu</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optMesu</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">optMesu</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading dark... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sessDark</span><span class="p">(</span><span class="n">darkLoc</span><span class="p">);</span>
  <span class="n">auto</span> <span class="n">optDark</span> <span class="o">=</span> <span class="n">sessDark</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optDark</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">dark</span> <span class="o">=</span> <span class="n">optDark</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading white... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sessWhite</span><span class="p">(</span><span class="n">whiteLoc</span><span class="p">);</span>
  <span class="n">auto</span> <span class="n">optWhite</span> <span class="o">=</span> <span class="n">sessWhite</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optWhite</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">white</span> <span class="o">=</span> <span class="n">optWhite</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading distance... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sessDistance</span><span class="p">(</span><span class="n">distanceLoc</span><span class="p">);</span>
  <span class="n">auto</span> <span class="n">optDistance</span> <span class="o">=</span> <span class="n">sessDistance</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optDistance</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">optDistance</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Data 1&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;t=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">integration_time</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; ms &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;mode=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">processing_mode</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Loading processing context&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">ProcessingContext</span> <span class="n">proc</span><span class="p">(</span><span class="n">sessMesu</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Set references&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">proc</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">dark</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">reference_type_t</span><span class="p">::</span><span class="n">Reference_Dark</span><span class="p">);</span>
  <span class="n">proc</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">white</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">reference_type_t</span><span class="p">::</span><span class="n">Reference_White</span><span class="p">);</span>
  <span class="n">proc</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">reference_type_t</span><span class="p">::</span><span class="n">Reference_Distance</span><span class="p">);</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">ProcessingArgs</span> <span class="n">procArgs</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SaveArgs</span> <span class="n">saveArgs</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_info_file</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="nb">map</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">string</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="o">&gt;</span> <span class="n">target_modes</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">{</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Cube_Raw</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;DS&quot;</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Cube_DarkSubtract</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;Ref&quot;</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Cube_Reflectance</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;RAD&quot;</span><span class="p">,</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Cube_SpectralRadiance</span><span class="p">}};</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">auto</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">mode</span> <span class="p">:</span> <span class="n">target_modes</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">second</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">is_capable</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="n">procArgs</span><span class="p">))</span>
    <span class="p">{</span>
      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;processing to mode &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mode</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
      <span class="n">proc</span><span class="o">.</span><span class="n">set_processingArgs</span><span class="p">(</span><span class="n">procArgs</span><span class="p">);</span>
      <span class="n">proc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
      <span class="n">saveArgs</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">filesystem</span><span class="p">::</span><span class="n">path</span><span class="p">(</span><span class="n">outDir</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="o">.</span><span class="n">first</span><span class="p">;</span>

      <span class="n">cuvis</span><span class="p">::</span><span class="n">CubeExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">);</span>
      <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;cannot process to mode &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mode</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">shutdown</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;finished.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_reprocessMeasurement</span><span class="p">(</span>
        <span class="n">userSettingsDir</span><span class="p">,</span>
        <span class="n">measurementLoc</span><span class="p">,</span>
        <span class="n">darkLoc</span><span class="p">,</span>
        <span class="n">whiteLoc</span><span class="p">,</span>
        <span class="n">distanceLoc</span><span class="p">,</span>
        <span class="n">outDir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading measurement file...&quot;</span><span class="p">)</span>
    <span class="n">sessionM</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">)</span>
    <span class="n">mesu</span> <span class="o">=</span> <span class="n">sessionM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">mesu</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading dark...&quot;</span><span class="p">)</span>
    <span class="n">sessionDk</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">darkLoc</span><span class="p">)</span>
    <span class="n">dark</span> <span class="o">=</span> <span class="n">sessionDk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">dark</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading white...&quot;</span><span class="p">)</span>
    <span class="n">sessionWt</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">whiteLoc</span><span class="p">)</span>
    <span class="n">white</span> <span class="o">=</span> <span class="n">sessionWt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">white</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading distance...&quot;</span><span class="p">)</span>
    <span class="n">sessionDc</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">distanceLoc</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">sessionDc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">distance</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data 1 </span><span class="si">{}</span><span class="s2"> t=</span><span class="si">{}</span><span class="s2">ms mode=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">processing_mode</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading processing context...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingContext</span><span class="p">(</span><span class="n">sessionM</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;set references...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">dark</span><span class="p">,</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ReferenceType</span><span class="o">.</span><span class="n">Dark</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">white</span><span class="p">,</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ReferenceType</span><span class="o">.</span><span class="n">White</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">set_reference</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ReferenceType</span><span class="o">.</span><span class="n">Distance</span><span class="p">)</span>

    <span class="n">procArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingArgs</span><span class="p">()</span>
    <span class="n">saveArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SaveArgs</span><span class="p">(</span><span class="n">allow_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">allow_session_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">allow_info_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Raw</span><span class="p">,</span>
             <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">DarkSubtract</span><span class="p">,</span>
             <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Reflectance</span><span class="p">,</span>
             <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">SpectralRadiance</span>
             <span class="p">]</span>

    <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span>

        <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">mode</span>

        <span class="k">if</span> <span class="n">processingContext</span><span class="o">.</span><span class="n">is_capable</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="n">procArgs</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;processing to mode </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
            <span class="n">processingContext</span><span class="o">.</span><span class="n">set_processing_args</span><span class="p">(</span><span class="n">procArgs</span><span class="p">)</span>
            <span class="n">mesu</span> <span class="o">=</span> <span class="n">processingContext</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
            <span class="n">mesu</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">saveArgs</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">outDir</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">exporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">Export</span><span class="o">.</span><span class="n">CubeExporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">)</span>
            <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot process to </span><span class="si">{}</span><span class="s2"> mode!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">))</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default images</span>
    <span class="n">loc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single_raw.cu3s&quot;</span>
    <span class="n">loc_dark</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single_dark.cu3s&quot;</span>
    <span class="n">loc_white</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single_white.cu3s&quot;</span>

    <span class="n">loc_distance</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single_distance.cu3s&quot;</span>

    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX02_reprocessed&quot;</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Example 02: Reprocess Measurement. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">measurementLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Measurement file (.cu3s) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">measurementLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">loc_file</span>

    <span class="n">darkLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Dark file (.cu3s) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_dark</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">darkLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">darkLoc</span> <span class="o">=</span> <span class="n">loc_dark</span>

    <span class="n">whiteLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;White file (.cu3s) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_white</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">whiteLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">whiteLoc</span> <span class="o">=</span> <span class="n">loc_white</span>

    <span class="n">distanceLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Distance file (.cu3s) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_distance</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">distanceLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">distanceLoc</span> <span class="o">=</span> <span class="n">loc_distance</span>

    <span class="n">outDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of output directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">outDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">outDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">run_example_reprocessMeasurement</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="n">darkLoc</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="n">whiteLoc</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="n">distanceLoc</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="n">outDir</span><span class="p">))</span>
</pre></div>
</div>
</div></div>
</section>
<section id="exporting-a-measurement">
<h2>Exporting a Measurement<a class="headerlink" href="#exporting-a-measurement" title="Link to this heading"></a></h2>
<p>This example demonstrates exporting hyperspectral measurement data into various formats using the cuvis SDK.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-2-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &quot;cuvis.h&quot;

#include &lt;assert.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;


int main(int argc, char* argv[])
{
  if (argc != 5)
  {
    printf(&quot;To few Arguments! Please provide:\n&quot;);
    printf(&quot;user settings directory\n&quot;);
    printf(&quot;sessionfile (.cu3s)\n&quot;);
    printf(&quot;user plugin file (.xml)\n&quot;);
    printf(&quot;Name of export directory\n&quot;);
    fflush(stdout);

    return -1;
  }
  const char* userSettingsDir = argv[1];
  const char* sessionLoc = argv[2];
  const char* pluginLoc = argv[3];
  const char* exportDir = argv[4];

  printf(&quot;Example 03 export measurement\n&quot;);
  printf(&quot;User Settings Dir: &quot;);
  printf(userSettingsDir);
  printf(&quot;\nsessionfile (.cu3s): &quot;);
  printf(sessionLoc);
  printf(&quot;\nuser plugin file (.xml): &quot;);
  printf(pluginLoc);
  printf(&quot;\nExport Dir: &quot;);
  printf(exportDir);
  fflush(stdout);

  CUVIS_SESSION_FILE sess;
  CUVIS_MESU mesu;

  CUVIS_EXPORTER envi_exporter;
  CUVIS_EXPORTER single_tiff_exporter;

  CUVIS_EXPORT_TIFF_SETTINGS single_tiff_settings;

  CUVIS_EXPORTER multi_tiff_exporter;
  CUVIS_EXPORT_TIFF_SETTINGS multi_tiff_settings;

  CUVIS_EXPORTER view_exporter;
  CUVIS_EXPORT_VIEW_SETTINGS view_settings;

  CUVIS_EXPORTER cube_exporter;

  char* buffer = 0;
  long length;
  FILE* f;

  printf(&quot;\nloading user settings...\n&quot;);
  fflush(stdout);

  CUVIS_CHECK(cuvis_init(userSettingsDir, loglevel_debug));
#ifdef _DEBUG
  CUVIS_CHECK(cuvis_set_log_level(loglevel_debug));
#else
  CUVIS_CHECK(cuvis_set_log_level(loglevel_info));
#endif

  CUVIS_EXPORT_GENERAL_SETTINGS general_settings_envi = {
      &quot;&quot;, //initializer list only takes const char*, leave empty and modify afterwards.
      &quot;all&quot;,
      1,
      0.0,
      pan_sharpening_interpolation_type_NearestNeighbor,
      pan_sharpening_algorithm_Noop,
      0,
      0};

  char exportDirEnvi[CUVIS_MAXBUF];
  strcpy(exportDirEnvi, exportDir);
  strcat(exportDirEnvi, &quot;/envi&quot;);
  strcpy(general_settings_envi.export_dir, exportDirEnvi);

  CUVIS_EXPORT_GENERAL_SETTINGS general_settings_single = {
      &quot;&quot;, //initializer list only takes const char*, leave empty and modify afterwards.
      &quot;all&quot;,
      1,
      0.0,
      pan_sharpening_interpolation_type_NearestNeighbor,
      pan_sharpening_algorithm_Noop,
      0,
      0};
  char exportDirSingle[CUVIS_MAXBUF];
  strcpy(exportDirSingle, exportDir);
  strcat(exportDirSingle, &quot;/single&quot;);
  strcpy(general_settings_single.export_dir, exportDirSingle);

  CUVIS_EXPORT_GENERAL_SETTINGS general_settings_multi = {
      &quot;&quot;, //initializer list only takes const char*, leave empty and modify afterwards.
      &quot;all&quot;,
      1,
      0.0,
      pan_sharpening_interpolation_type_NearestNeighbor,
      pan_sharpening_algorithm_Noop,
      0,
      0};
  char exportDirMulti[CUVIS_MAXBUF];
  strcpy(exportDirMulti, exportDir);
  strcat(exportDirMulti, &quot;/multi&quot;);
  strcpy(general_settings_multi.export_dir, exportDirMulti);

  CUVIS_EXPORT_GENERAL_SETTINGS general_settings_view = {
      &quot;&quot;, //initializer list only takes const char*, leave empty and modify afterwards.
      &quot;all&quot;,
      1,
      0.0,
      pan_sharpening_interpolation_type_NearestNeighbor,
      pan_sharpening_algorithm_Noop,
      0,
      0};
  char exportDirView[CUVIS_MAXBUF];
  strcpy(exportDirView, exportDir);
  strcat(exportDirView, &quot;/view&quot;);
  strcpy(general_settings_view.export_dir, exportDirView);

  CUVIS_EXPORT_CUBE_SETTINGS cube_settings_session = {
      0, 1, 0, 1, 1, OperationMode_Software, 1.0, 64, 128, 60000};
  CUVIS_EXPORT_GENERAL_SETTINGS general_settings_session = {
      &quot;&quot;, //initializer list only takes const char*, leave empty and modify afterwards.
      &quot;all&quot;,
      1,
      0.0,
      pan_sharpening_interpolation_type_NearestNeighbor,
      pan_sharpening_algorithm_Noop,
      0,
      0};
  char exportDirSession[CUVIS_MAXBUF];
  strcpy(exportDirSession, exportDir);
  strcat(exportDirSession, &quot;/session&quot;);
  strcpy(general_settings_session.export_dir, exportDirSession);

  printf(&quot;loading session ...\n&quot;);
  fflush(stdout);
  CUVIS_CHECK(cuvis_session_file_load(sessionLoc, &amp;sess));

  printf(&quot;loading measurement ...\n&quot;);
  fflush(stdout);
  CUVIS_CHECK(cuvis_session_file_get_mesu(
      sess, 0, session_item_type_frames_no_gaps, &amp;mesu));

  printf(&quot;creating envi exporter ...\n&quot;);
  fflush(stdout);
  CUVIS_CHECK(
      cuvis_exporter_create_envi(&amp;envi_exporter, general_settings_envi));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;creating single tiff exporter ...\n&quot;);
  fflush(stdout);

  single_tiff_settings.compression_mode = tiff_compression_mode_None;
  single_tiff_settings.format = tiff_format_Single;
  CUVIS_CHECK(cuvis_exporter_create_tiff(
      &amp;single_tiff_exporter, general_settings_single, single_tiff_settings));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;creating multi tiff exporter ...\n&quot;);
  fflush(stdout);

  multi_tiff_settings.compression_mode = tiff_compression_mode_None;
  multi_tiff_settings.format = tiff_format_MultiChannel;
  CUVIS_CHECK(cuvis_exporter_create_tiff(
      &amp;multi_tiff_exporter, general_settings_multi, multi_tiff_settings));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;creating view exporter ...\n&quot;);
  printf(&quot;loading plugin ...\n&quot;);
  fflush(stdout);

  f = fopen(pluginLoc, &quot;rb&quot;);

  if (f)
  {
    fseek(f, 0, SEEK_END);
    length = ftell(f);
    fseek(f, 0, SEEK_SET);
    buffer = malloc(length);
    if (buffer)
    {
      fread(buffer, 1, length, f);
    }
    fclose(f);
  }
  if (!buffer)
  {
    printf(&quot;failed to load plugin file\n&quot;);
    fflush(stdout);

    return 0;
  }

  view_settings.userplugin = buffer;
  CUVIS_CHECK(cuvis_exporter_create_view(
      &amp;view_exporter, general_settings_view, view_settings));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;creating cube exporter (session) ...\n&quot;);
  fflush(stdout);
  CUVIS_CHECK(cuvis_exporter_create_cube(
      &amp;cube_exporter, general_settings_session, cube_settings_session));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;export envi...&quot;);
  fflush(stdout);

  CUVIS_CHECK(cuvis_exporter_apply(envi_exporter, mesu));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;export single tiff...&quot;);
  fflush(stdout);
  CUVIS_CHECK(cuvis_exporter_apply(single_tiff_exporter, mesu));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;export multi tiff...&quot;);
  fflush(stdout);

  CUVIS_CHECK(cuvis_exporter_apply(multi_tiff_exporter, mesu));
  printf(&quot; done.\n&quot;);
  fflush(stdout);

  printf(&quot;export view...&quot;);
  fflush(stdout);

  CUVIS_CHECK(cuvis_exporter_apply(view_exporter, mesu));
  printf(&quot;done.\n&quot;);
  fflush(stdout);

  printf(&quot;export cube (session)...&quot;);
  fflush(stdout);

  CUVIS_CHECK(cuvis_exporter_apply(cube_exporter, mesu));
  printf(&quot;done.\n&quot;);
  fflush(stdout);

  cuvis_measurement_free(&amp;mesu);
  cuvis_session_file_free(&amp;sess);
  cuvis_exporter_free(&amp;envi_exporter);
  cuvis_exporter_free(&amp;single_tiff_exporter);
  cuvis_exporter_free(&amp;multi_tiff_exporter);
  cuvis_exporter_free(&amp;view_exporter);
  cuvis_exporter_free(&amp;cube_exporter);
  cuvis_shutdown();

  free(buffer);
  printf(&quot;finished.\n&quot;);
  fflush(stdout);

  return 0;
}
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.hpp&quot;</span>

<span class="c1">#include &lt;cassert&gt;</span>
<span class="c1">#include &lt;fstream&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Too few Arguments! Please provide:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user settings directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user plugin file (.xml)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Name of export directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">pluginLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exportDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Example 03 export measurement&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;User Settings Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">userSettingsDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sessionLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user plugin file (.xml): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">pluginLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">exportDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading settings... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading session... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sess</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading measurement... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">auto</span> <span class="n">optmesu</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optmesu</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">optmesu</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="k">assert</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">processing_mode</span> <span class="o">!=</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Preview</span><span class="p">);</span>

  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export to Envi&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">EnviArgs</span> <span class="n">args</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">exportDirEnvi</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirEnvi</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirEnvi</span><span class="p">,</span> <span class="s2">&quot;/envi&quot;</span><span class="p">);</span>
    <span class="n">args</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDirEnvi</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">EnviExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
    <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export to Multi-Channel Tiff&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">TiffArgs</span> <span class="n">args</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">exportDirMulti</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirMulti</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirMulti</span><span class="p">,</span> <span class="s2">&quot;/multi&quot;</span><span class="p">);</span>
    <span class="n">args</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDirMulti</span><span class="p">;</span>
    <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">tiff_format_t</span><span class="p">::</span><span class="n">tiff_format_MultiChannel</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">TiffExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
    <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export to separate Tiffs&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">TiffArgs</span> <span class="n">args</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">exportDirSingle</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirSingle</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirSingle</span><span class="p">,</span> <span class="s2">&quot;/single&quot;</span><span class="p">);</span>
    <span class="n">args</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDirSingle</span><span class="p">;</span>
    <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">tiff_format_t</span><span class="p">::</span><span class="n">tiff_format_Single</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">TiffExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
    <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export View to file&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">cuvis</span><span class="p">::</span><span class="n">ViewArgs</span> <span class="n">args</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">exportDirView</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirView</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirView</span><span class="p">,</span> <span class="s2">&quot;/view&quot;</span><span class="p">);</span>
    <span class="n">args</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDirView</span><span class="p">;</span>

    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Load plugin&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">ifstream</span> <span class="n">file</span><span class="p">(</span><span class="n">pluginLoc</span><span class="p">);</span>
    <span class="n">args</span><span class="o">.</span><span class="n">userplugin</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">string</span><span class="p">(</span>
        <span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">istreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">file</span><span class="p">)),</span>
        <span class="n">std</span><span class="p">::</span><span class="n">istreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span><span class="p">());</span>

    <span class="n">cuvis</span><span class="p">::</span><span class="n">ViewExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
    <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export to sessionfile&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">exportDirView</span><span class="p">[</span><span class="n">CUVIS_MAXBUF</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">exportDirView</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">exportDirView</span><span class="p">,</span> <span class="s2">&quot;/session&quot;</span><span class="p">);</span>

    <span class="n">cuvis</span><span class="p">::</span><span class="n">SaveArgs</span> <span class="n">saveArgs</span><span class="p">;</span>
    <span class="n">saveArgs</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDirView</span><span class="p">;</span>
    <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>

    <span class="n">cuvis</span><span class="p">::</span><span class="n">CubeExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">);</span>
    <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">shutdown</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;finished.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_exportMeasurement</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span>
                                  <span class="n">measurementLoc</span><span class="p">,</span>
                                  <span class="n">pluginLoc</span><span class="p">,</span>
                                  <span class="n">exportDir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading session file...&quot;</span><span class="p">)</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">)</span>
    <span class="n">mesu</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">mesu</span><span class="o">.</span><span class="n">_handle</span>

    <span class="k">assert</span> <span class="n">mesu</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">!=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Preview</span><span class="p">,</span> <span class="s2">&quot;Wrong processing mode: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">mesu</span><span class="o">.</span><span class="n">processing_mode</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Export to Envi...&quot;</span><span class="p">)</span>
    <span class="n">envi_settings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">EnviExportSettings</span><span class="p">(</span>
        <span class="n">export_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exportDir</span><span class="p">,</span> <span class="s2">&quot;envi&quot;</span><span class="p">))</span>
    <span class="n">enviExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">EnviExporter</span><span class="p">(</span><span class="n">envi_settings</span><span class="p">)</span>
    <span class="n">enviExporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Export to Multi-Channel Tiff...&quot;</span><span class="p">)</span>
    <span class="n">multi_tiff_settings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">TiffExportSettings</span><span class="p">(</span>
        <span class="n">export_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exportDir</span><span class="p">,</span> <span class="s2">&quot;multi&quot;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">cuvis</span><span class="o">.</span><span class="n">TiffFormat</span><span class="o">.</span><span class="n">MultiChannel</span><span class="p">)</span>
    <span class="n">multiTiffExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">TiffExporter</span><span class="p">(</span><span class="n">multi_tiff_settings</span><span class="p">)</span>
    <span class="n">multiTiffExporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Export to separate Tiffs...&quot;</span><span class="p">)</span>
    <span class="n">single_tiff_settings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">TiffExportSettings</span><span class="p">(</span>
        <span class="n">export_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exportDir</span><span class="p">,</span> <span class="s2">&quot;single&quot;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">cuvis</span><span class="o">.</span><span class="n">TiffFormat</span><span class="o">.</span><span class="n">Single</span><span class="p">)</span>
    <span class="n">singleTiffExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">TiffExporter</span><span class="p">(</span><span class="n">single_tiff_settings</span><span class="p">)</span>
    <span class="n">singleTiffExporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Export View to file...&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;load plugin...&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pluginLoc</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">userpluginCai</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">userpluginCai</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">userpluginCai</span><span class="p">)</span>

    <span class="n">view_export_settings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ViewExportSettings</span><span class="p">(</span>
        <span class="n">export_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exportDir</span><span class="p">,</span> <span class="s2">&quot;view&quot;</span><span class="p">),</span> <span class="n">userplugin</span><span class="o">=</span><span class="n">userpluginCai</span><span class="p">)</span>
    <span class="c1"># also view_export_settings = cuvis.ViewExportSettings(ExportDir=os.path.join(exportDir, &quot;view&quot;),</span>
    <span class="c1"># Userplugin=pluginLoc) works!</span>
    <span class="n">viewExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ViewExporter</span><span class="p">(</span><span class="n">view_export_settings</span><span class="p">)</span>
    <span class="n">viewExporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>
        <span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;user&quot;</span> <span class="o">/</span> <span class="s2">&quot;plugin&quot;</span>

    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">))</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>
        <span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">lib_dir</span> <span class="o">/</span> <span class="s2">&quot;user&quot;</span> <span class="o">/</span> <span class="s2">&quot;plugin&quot;</span>

    <span class="c1"># default images</span>
    <span class="n">loc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single.cu3s&quot;</span>
    <span class="n">loc_plugin</span> <span class="o">=</span> <span class="n">plugin_dir</span> <span class="o">/</span> <span class="s2">&quot;ref&quot;</span> <span class="o">/</span> <span class="s2">&quot;cai.xml&quot;</span>

    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX03_export&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 03: Export Measurement. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">measurementLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Measurement file (.cu3) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">measurementLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">loc_file</span>

    <span class="n">pluginLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User plugin file (.xml) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_plugin</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">pluginLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">pluginLoc</span> <span class="o">=</span> <span class="n">loc_plugin</span>

    <span class="n">exportDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of export directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">exportDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">exportDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">run_example_exportMeasurement</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">pluginLoc</span><span class="p">),</span>
                                  <span class="nb">str</span><span class="p">(</span><span class="n">exportDir</span><span class="p">))</span>
</pre></div>
</div>
</div></div>
</section>
<section id="changing-the-distance-of-a-measurement">
<h2>Changing the Distance of a Measurement<a class="headerlink" href="#changing-the-distance-of-a-measurement" title="Link to this heading"></a></h2>
<p>This example demonstrates how to update the distance parameter in hyperspectral measurement data using the cuvis SDK.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-3-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-3-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;sessionfile (.cu3s)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;new distance</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Name of export directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">distanceString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exportDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">distanceString</span><span class="p">);</span> <span class="o">//</span><span class="ow">in</span> <span class="n">mm</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 04 change distance cpp </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">sessionfile (.cu3s): &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">New Distance: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">distance</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Export Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">exportDir</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sess</span><span class="p">;</span>

  <span class="n">CUVIS_MESU</span> <span class="n">mesu</span><span class="p">;</span>
  <span class="n">CUVIS_MESU_METADATA</span> <span class="n">mesu_data</span><span class="p">;</span>

  <span class="n">CUVIS_PROC_CONT</span> <span class="n">procCont</span><span class="p">;</span>

  <span class="n">CUVIS_INT</span> <span class="n">is_capable</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">loading settings... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>
<span class="c1">#ifdef _DEBUG</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_set_log_level</span><span class="p">(</span><span class="n">loglevel_debug</span><span class="p">));</span>
<span class="c1">#else</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">));</span>
<span class="c1">#endif</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">loading session... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sess</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">loading measurement... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_get_mesu</span><span class="p">(</span>
      <span class="n">sess</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">session_item_type_frames_no_gaps</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu</span><span class="p">));</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
  <span class="n">printf</span><span class="p">(</span>
      <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
      <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Load calibration and processing context...&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_create_from_session_file</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">procCont</span><span class="p">));</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;prepare saving of measurements... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>

  <span class="n">CUVIS_EXPORT_GENERAL_SETTINGS</span> <span class="n">general_settings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">initializer</span> <span class="nb">list</span> <span class="n">only</span> <span class="n">takes</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="n">leave</span> <span class="n">empty</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">afterwards</span><span class="o">.</span>
      <span class="s2">&quot;all&quot;</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="mf">0.0</span><span class="p">,</span>
      <span class="n">pan_sharpening_interpolation_type_NearestNeighbor</span><span class="p">,</span>
      <span class="n">pan_sharpening_algorithm_Noop</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">};</span>

  <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">exportDir</span><span class="p">);</span>

  <span class="n">CUVIS_EXPORT_CUBE_SETTINGS</span> <span class="n">cube_settings</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_fragmentation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="n">cuvis_exporter_create_cube</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Set distance ...&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="o">//</span><span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_calc_distance</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">distance</span><span class="p">));</span> <span class="o">//</span> <span class="n">throws</span> <span class="n">error</span> <span class="n">on</span> <span class="n">pan</span> <span class="n">image</span>
  <span class="n">cuvis_proc_cont_calc_distance</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">distance</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_PROC_ARGS</span> <span class="n">args</span><span class="p">;</span>
  <span class="n">args</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Raw</span><span class="p">;</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_is_capable</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_capable</span><span class="p">));</span>

  <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">is_capable</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;reprocess measurement to Cube_Raw with custom distance mode...&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">args</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_apply</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">mesu</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; done. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s2">&quot;data 1 </span><span class="si">%s</span><span class="s2"> </span><span class="si">%.2f</span><span class="s2"> ms mode=</span><span class="si">%d</span><span class="s2"> flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">processing_mode</span><span class="p">,</span>
        <span class="n">mesu_data</span><span class="o">.</span><span class="n">measurement_flags</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">cuvis_exporter_apply</span><span class="p">(</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">mesu</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Cannot process to Cube_Raw mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="n">cuvis_proc_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mesu</span><span class="p">);</span>
  <span class="n">cuvis_shutdown</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.hpp&quot;</span>

<span class="c1">#include &lt;cassert&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Too few Arguments! Please provide:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user settings directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s)&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;new distance in mm&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Name of export directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionLoc</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">distanceString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exportDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">stoi</span><span class="p">(</span><span class="n">distanceString</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Example 04 change distance cpp &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;User Settings Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">userSettingsDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;sessionfile (.cu3s): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sessionLoc</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;New Distance in mm: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">distance</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Export Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">exportDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading settings... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading session... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">SessionFile</span> <span class="n">sess</span><span class="p">(</span><span class="n">sessionLoc</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading measurement... &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">auto</span> <span class="n">optmesu</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get_mesu</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">optmesu</span><span class="o">.</span><span class="n">has_value</span><span class="p">());</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Measurement</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">optmesu</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Data 1&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;t=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">integration_time</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; ms &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="s2">&quot;mode=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mesu</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">processing_mode</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Loading Calibration and processing context...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">ProcessingContext</span> <span class="n">proc</span><span class="p">(</span><span class="n">sess</span><span class="p">);</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">SaveArgs</span> <span class="n">saveArgs</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">exportDir</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">CubeExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;setting distance...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">proc</span><span class="o">.</span><span class="n">calc_distance</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">ProcessingArgs</span> <span class="n">procArgs</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">get_processingArgs</span><span class="p">();</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">processing_mode_t</span><span class="p">::</span><span class="n">Cube_Raw</span><span class="p">;</span>

  <span class="k">assert</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">is_capable</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="n">procArgs</span><span class="p">));</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;changing distance...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">proc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;saving...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">shutdown</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;finished.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_changeDistance</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span>
                               <span class="n">measurementLoc</span><span class="p">,</span>
                               <span class="n">distance</span><span class="p">,</span>
                               <span class="n">exportDir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading session file...&quot;</span><span class="p">)</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">)</span>
    <span class="n">mesu</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">mesu</span><span class="o">.</span><span class="n">_handle</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data 1 </span><span class="si">{}</span><span class="s2"> t=</span><span class="si">{}</span><span class="s2">ms mode=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">integration_time</span><span class="p">,</span>
                                            <span class="n">mesu</span><span class="o">.</span><span class="n">processing_mode</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading calibration and processing context (factory)...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingContext</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;setting distance...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">calc_distance</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="n">processingContext</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Raw</span>

    <span class="n">saveArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SaveArgs</span><span class="p">(</span><span class="n">export_dir</span><span class="o">=</span><span class="n">exportDir</span><span class="p">,</span> <span class="n">allow_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">processingContext</span><span class="o">.</span><span class="n">is_capable</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span>
                                        <span class="n">processingContext</span><span class="o">.</span><span class="n">get_processing_args</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;changing distance...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original distance...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;new distance...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;saving...&quot;</span><span class="p">)</span>
    <span class="n">mesu</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">)</span>

    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">))</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default image</span>
    <span class="n">loc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set0_single&quot;</span> <span class="o">/</span> <span class="s2">&quot;single.cu3s&quot;</span>
    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="n">loc_distance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX04_distance_changed&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 04: Change distance. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">measurementLoc</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Measurement file (.cu3) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">measurementLoc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">measurementLoc</span> <span class="o">=</span> <span class="n">loc_file</span>

    <span class="n">distance</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;New distance in mm (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_distance</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">distance</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">loc_distance</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="n">exportDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of export directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">exportDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">exportDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">run_example_changeDistance</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">),</span>
                               <span class="n">distance</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">exportDir</span><span class="p">))</span>
</pre></div>
</div>
</div></div>
</section>
<section id="recording-single-measurements">
<h2>Recording single Measurements<a class="headerlink" href="#recording-single-measurements" title="Link to this heading"></a></h2>
<p>This example demonstrates how to capture single hyperspectral images using the cuvis SDK, with user-defined settings and parameters.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-4-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-4-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-4-Qw==" class="sphinx-tabs-panel group-tab" id="panel-4-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;stdbool.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="c1">#ifdef WIN32</span>
  <span class="c1">#include &lt;Windows.h&gt;</span>
<span class="c1">#else</span>
  <span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#endif</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;factory directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;path of recording directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;exposure time in ms</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;number of images</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">recDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exposureString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="o">//</span><span class="ow">in</span> <span class="n">ms</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">nrImagesString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">exposure_ms</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">exposureString</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">nrImages</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">nrImagesString</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 05 record single image</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;User Settings directory: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Factory directory: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recording directory: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">recDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exposure in ms: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exposure_ms</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Number of images: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nrImages</span><span class="p">);</span>

  <span class="n">CUVIS_CALIB</span> <span class="n">calib</span><span class="p">;</span>
  <span class="n">CUVIS_ACQ_CONT</span> <span class="n">acqCont</span><span class="p">;</span>
  <span class="n">CUVIS_PROC_CONT</span> <span class="n">procCont</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;load user settings...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>
  <span class="n">cuvis_set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;load calibration...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_calib_create_from_path</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">calib</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initialize processing context...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_create_from_calib</span><span class="p">(</span><span class="n">calib</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">procCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initialize acquisition context...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_create_from_calib</span><span class="p">(</span><span class="n">calib</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">acqCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initialize measurement exporter...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Export</span> <span class="n">settings</span><span class="p">:</span> <span class="n">General</span> <span class="n">processing</span> <span class="n">of</span> <span class="n">measurements</span>
  <span class="n">CUVIS_EXPORT_GENERAL_SETTINGS</span> <span class="n">general_settings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">initializer</span> <span class="nb">list</span> <span class="n">only</span> <span class="n">takes</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="n">leave</span> <span class="n">empty</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">afterwards</span><span class="o">.</span>
      <span class="s2">&quot;all&quot;</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="mf">0.0</span><span class="p">,</span>
      <span class="n">pan_sharpening_interpolation_type_NearestNeighbor</span><span class="p">,</span>
      <span class="n">pan_sharpening_algorithm_Noop</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">};</span>

  <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">recDir</span><span class="p">);</span>

  <span class="o">//</span> <span class="n">Cube</span> <span class="n">exporter</span> <span class="n">specific</span> <span class="n">settings</span>
  <span class="n">CUVIS_EXPORT_CUBE_SETTINGS</span> <span class="n">cube_settings</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_fragmentation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_info_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">hard_limit</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">soft_limit</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Settings</span> <span class="k">for</span> <span class="n">worker</span> <span class="p">(</span><span class="n">processing</span> <span class="n">pipeline</span><span class="p">)</span>
  <span class="n">CUVIS_WORKER_SETTINGS</span> <span class="n">worker_settings</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_drop_results</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_measurements</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_supplementary_steps</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">input_queue_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">output_queue_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">mandatory_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">supplementary_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">cuvis_exporter_create_cube</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initialize processing pipeline worker...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_WORKER</span> <span class="n">worker</span><span class="p">;</span>
  <span class="n">cuvis_worker_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">,</span> <span class="n">worker_settings</span><span class="p">);</span>

  <span class="n">CUVIS_PROC_ARGS</span> <span class="n">procArgs</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">allow_recalib</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Raw</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;waiting for camera to become online...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_HARDWARE_STATE</span> <span class="n">state</span><span class="p">;</span>
    <span class="n">cuvis_acq_cont_get_state</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">state</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_partially_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera partially online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

<span class="c1">#ifdef WIN32</span>
    <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">#else</span>
    <span class="n">usleep</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>
<span class="c1">#endif</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;camera components details:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_INT</span> <span class="n">compCount</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_count</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">compCount</span><span class="p">));</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">compIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">compIdx</span> <span class="o">&lt;</span> <span class="n">compCount</span><span class="p">;</span> <span class="n">compIdx</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_INT</span> <span class="n">online</span><span class="p">;</span>
    <span class="n">CUVIS_COMPONENT_INFO</span> <span class="n">cinfo</span><span class="p">;</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_info</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cinfo</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_comp_online_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">online</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; - component &#39;</span><span class="si">%s</span><span class="s2">&#39; is &quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">displayname</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">online</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;offline</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- info:        </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">sensorinfo</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- use:         </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">userfield</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- pixelformat: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">pixelformat</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;configuring camera components...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="o">//</span> <span class="n">Configure</span> <span class="n">exposure</span> <span class="o">/</span> <span class="n">integration</span> <span class="n">time</span> <span class="ow">and</span> <span class="n">software</span> <span class="n">trigger</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_integration_time_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">exposure_ms</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_operation_mode_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">OperationMode_Software</span><span class="p">));</span>

  <span class="o">//</span> <span class="n">Assign</span> <span class="n">contexts</span> <span class="n">to</span> <span class="n">worker</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_set_acq_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">acqCont</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_set_proc_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">procCont</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_set_exporter</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">cube_exporter</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;start recording now</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_start</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>

  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">nrImages</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;trigger image nr. </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nrImages</span><span class="p">);</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_capture_async</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">NULL</span><span class="p">));</span>

    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;waiting for processing...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_get_next_result</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">exposure_ms</span> <span class="o">+</span> <span class="mi">2000</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_stop</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;done. cleaning up...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>

  <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="n">cuvis_proc_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_acq_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">acqCont</span><span class="p">);</span>
  <span class="n">cuvis_calib_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">calib</span><span class="p">);</span>
  <span class="n">cuvis_worker_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">);</span>

  <span class="n">cuvis_shutdown</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;finished.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.hpp&quot;</span>

<span class="c1">#include &lt;cassert&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Too few Arguments! Please provide:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;user settings directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;factory directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;name of recording directory&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;exposure time in ms&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;number of images&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">recDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exposureString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">nrImagesString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">exposure_ms</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">stoi</span><span class="p">(</span><span class="n">exposureString</span><span class="p">);</span>
  <span class="nb">int</span> <span class="n">nrImages</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">stoi</span><span class="p">(</span><span class="n">nrImagesString</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Example 05 record single image &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;User Settings Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">userSettingsDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Factory Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">factoryDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Recording Dir: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">recDir</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Exposure in ms: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">exposure_ms</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Number of Images: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nrImages</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;loading user settings...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">loglevel_info</span><span class="p">);</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Loading Calibration and processing context...&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">Calibration</span> <span class="n">calib</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">ProcessingContext</span> <span class="n">proc</span><span class="p">(</span><span class="n">calib</span><span class="p">);</span>
  <span class="n">cuvis</span><span class="p">::</span><span class="n">AcquisitionContext</span> <span class="n">acq</span><span class="p">(</span><span class="n">calib</span><span class="p">);</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">SaveArgs</span> <span class="n">saveArgs</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">export_dir</span> <span class="o">=</span> <span class="n">recDir</span><span class="p">;</span>
  <span class="n">saveArgs</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">CubeExporter</span> <span class="n">exporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">cuvis</span><span class="p">::</span><span class="n">hardware_state_t</span><span class="p">::</span><span class="n">hardware_state_offline</span> <span class="o">==</span> <span class="n">acq</span><span class="o">.</span><span class="n">get_state</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">this_thread</span><span class="p">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">chrono</span><span class="p">::</span><span class="n">seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Camera is online&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">acq</span><span class="o">.</span><span class="n">set_operation_mode</span><span class="p">(</span><span class="n">cuvis</span><span class="p">::</span><span class="n">operation_mode_t</span><span class="p">::</span><span class="n">OperationMode_Software</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">();</span>
  <span class="n">acq</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">exposure_ms</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">();</span>

  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Start recording now&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">nrImages</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Record image #&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;... (async) &quot;</span><span class="p">;</span>
    <span class="n">auto</span> <span class="n">async_mesu</span> <span class="o">=</span> <span class="n">acq</span><span class="o">.</span><span class="n">capture</span><span class="p">();</span>
    <span class="n">auto</span> <span class="n">mesu_res</span> <span class="o">=</span> <span class="n">async_mesu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">chrono</span><span class="p">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mesu_res</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">cuvis</span><span class="p">::</span><span class="n">async_result_t</span><span class="p">::</span><span class="n">done</span> <span class="o">&amp;&amp;</span>
        <span class="n">mesu_res</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">has_value</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="n">auto</span><span class="o">&amp;</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">mesu_res</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">value</span><span class="p">();</span>

      <span class="n">proc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>
      <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">);</span>

      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;done&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;failed&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="o">//</span><span class="n">uncomment</span> <span class="k">for</span> <span class="n">recording</span> <span class="ow">in</span> <span class="n">queue</span> <span class="n">mode</span>
  <span class="o">/*</span> 
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">nrImages</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Record image #&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;... (queue)&quot;</span><span class="p">;</span>
    <span class="n">acq</span><span class="o">.</span><span class="n">capture_queue</span><span class="p">();</span>
    <span class="n">auto</span> <span class="n">mesu</span> <span class="o">=</span> <span class="n">acq</span><span class="o">.</span><span class="n">get_next_measurement</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">chrono</span><span class="p">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">value</span><span class="p">());</span>
        <span class="n">exporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="o">.</span><span class="n">value</span><span class="p">());</span>
        <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;done&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;failed&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;done&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">*/</span>

  <span class="n">cuvis</span><span class="p">::</span><span class="n">General</span><span class="p">::</span><span class="n">shutdown</span><span class="p">();</span>
  <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;finished.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_recordSingleImage</span><span class="p">(</span>
        <span class="n">userSettingsDir</span><span class="p">,</span>
        <span class="n">factoryDir</span><span class="p">,</span>
        <span class="n">recDir</span><span class="p">,</span>
        <span class="n">exposure</span><span class="p">,</span>
        <span class="n">nrImgs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;loading calibration, processing and acquisition context (factory)...&quot;</span><span class="p">)</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">)</span>
    <span class="n">processingContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingContext</span><span class="p">(</span><span class="n">calibration</span><span class="p">)</span>
    <span class="n">acquisitionContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">AcquisitionContext</span><span class="p">(</span><span class="n">calibration</span><span class="p">)</span>

    <span class="n">saveArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SaveArgs</span><span class="p">(</span><span class="n">export_dir</span><span class="o">=</span><span class="n">recDir</span><span class="p">,</span> <span class="n">allow_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">allow_session_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cubeExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">CubeExporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">HardwareState</span><span class="o">.</span><span class="n">Offline</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera is online&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">OperationMode</span><span class="o">.</span><span class="n">Software</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="n">exposure</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start recoding now&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrImgs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Record image #</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2"> ... (async)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nrImgs</span><span class="p">))</span>
        <span class="n">am</span> <span class="o">=</span> <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">capture</span><span class="p">()</span>
        <span class="n">mesu</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">milliseconds</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">mesu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">processingContext</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
            <span class="n">cubeExporter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mesu</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed&quot;</span><span class="p">)</span>

    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>
    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">)</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default factory</span>
    <span class="n">loc_factory</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;factory&quot;</span>
    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX05_images&quot;</span>

    <span class="c1"># parameters</span>
    <span class="n">loc_exptime</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># in msw</span>
    <span class="n">loc_nimgs</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 05: Record single image. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">factoryDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Factory directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_factory</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">factoryDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">loc_factory</span>

    <span class="n">recDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of recording directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">recDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">recDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Exposure/Integration time in ms (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_exptime</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">exposure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">exposure</span> <span class="o">=</span> <span class="n">loc_exptime</span>
    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>

    <span class="n">nrImgs</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Number of Images (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_nimgs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">nrImgs</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">nrImgs</span> <span class="o">=</span> <span class="n">loc_nimgs</span>
    <span class="n">nrImgs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nrImgs</span><span class="p">)</span>

    <span class="n">run_example_recordSingleImage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">recDir</span><span class="p">),</span> <span class="n">exposure</span><span class="p">,</span>
                                  <span class="n">nrImgs</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="recording-a-video">
<h2>Recording a video<a class="headerlink" href="#recording-a-video" title="Link to this heading"></a></h2>
<p>This example demonstrates how to record a video sequence of hyperspectral data using the cuvis SDK.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-5-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-5-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-5-Qw==" class="sphinx-tabs-panel group-tab" id="panel-5-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;signal.h&gt;</span>
<span class="c1">#include &lt;stdbool.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="c1">#ifdef WIN32</span>
  <span class="c1">#include &lt;Windows.h&gt;</span>
<span class="c1">#else</span>
  <span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#endif</span>

<span class="nb">int</span> <span class="n">keepRunning</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">void</span> <span class="n">signal_handler</span><span class="p">(</span><span class="nb">int</span> <span class="n">sig</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">signal received. Stopping acquisiton...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="n">sig</span><span class="p">;</span>
  <span class="n">keepRunning</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;factory directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;name of recording directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;exposure time in ms</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;auto exposure [1/0]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;target fps</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">recDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exposureString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">autoExpString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">fpsString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">exposure_ms</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">exposureString</span><span class="p">);</span> <span class="o">//</span><span class="ow">in</span> <span class="n">ms</span>
  <span class="nb">bool</span> <span class="n">autoExp</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">atoi</span><span class="p">(</span><span class="n">autoExpString</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">autoExp</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">double</span> <span class="n">fps</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">fpsString</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 06 video&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">User Settings Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Factory Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recording Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">recDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exposure in ms: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exposure_ms</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Auto Exposure: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">autoExp</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Target FPS: </span><span class="si">%4.2f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_CALIB</span> <span class="n">calib</span><span class="p">;</span>
  <span class="n">CUVIS_ACQ_CONT</span> <span class="n">acqCont</span><span class="p">;</span>
  <span class="n">CUVIS_PROC_CONT</span> <span class="n">procCont</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading user settings...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading calibration...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_calib_create_from_path</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">calib</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading acquisition context... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_create_from_calib</span><span class="p">(</span><span class="n">calib</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">acqCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;load processing context </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_create_from_calib</span><span class="p">(</span><span class="n">calib</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">procCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;prepare saving of measurements... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>

  <span class="n">CUVIS_EXPORT_GENERAL_SETTINGS</span> <span class="n">general_settings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">initializer</span> <span class="nb">list</span> <span class="n">only</span> <span class="n">takes</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="n">leave</span> <span class="n">empty</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">afterwards</span><span class="o">.</span>
      <span class="s2">&quot;all&quot;</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="mf">0.0</span><span class="p">,</span>
      <span class="n">pan_sharpening_interpolation_type_NearestNeighbor</span><span class="p">,</span>
      <span class="n">pan_sharpening_algorithm_Noop</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">};</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">recDir</span><span class="p">);</span>

  <span class="n">CUVIS_EXPORT_CUBE_SETTINGS</span> <span class="n">cube_settings</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_fragmentation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">OperationMode_Internal</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_info_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">hard_limit</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">soft_limit</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>


  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span>
      <span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>

  <span class="n">CUVIS_PROC_ARGS</span> <span class="n">procArgs</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">allow_recalib</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Raw</span><span class="p">;</span>

  <span class="n">CUVIS_SESSION_INFO</span> <span class="n">sess</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;video&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_set_session_info</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sess</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;waiting for camera to become online...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(;;)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_HARDWARE_STATE</span> <span class="n">state</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_state</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">state</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_partially_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera partially online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

<span class="c1">#ifdef WIN32</span>
    <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">#else</span>
    <span class="n">usleep</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>
<span class="c1">#endif</span>

    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;component details:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_INT</span> <span class="n">compCount</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_count</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">compCount</span><span class="p">));</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">compIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">compIdx</span> <span class="o">&lt;</span> <span class="n">compCount</span><span class="p">;</span> <span class="n">compIdx</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_INT</span> <span class="n">online</span><span class="p">;</span>
    <span class="n">CUVIS_COMPONENT_INFO</span> <span class="n">cinfo</span><span class="p">;</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_info</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cinfo</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_comp_online_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">online</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; - component &#39;</span><span class="si">%s</span><span class="s2">&#39; is &quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">displayname</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">online</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;offline</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- info:        </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">sensorinfo</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- use:         </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">userfield</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- pixelformat: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">pixelformat</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initializing hardware...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_integration_time_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">exposure_ms</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span>
      <span class="n">cuvis_acq_cont_operation_mode_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">OperationMode_Internal</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_fps_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">fps</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_queue_size_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">procArgs</span><span class="p">));</span>

  <span class="n">cuvis_acq_cont_binning_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">CUVIS_WORKER</span> <span class="n">worker</span><span class="p">;</span>
  <span class="n">CUVIS_WORKER_SETTINGS</span> <span class="n">worker_settings</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_measurements</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>       <span class="o">//</span> <span class="n">Worker</span> <span class="n">cannot</span> <span class="n">skip</span> <span class="n">exporting</span> <span class="n">measurements</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_supplementary_steps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">//</span> <span class="n">Worker</span> <span class="n">can</span> <span class="n">skip</span> <span class="n">view</span> <span class="n">generation</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_drop_results</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>             <span class="o">//</span> <span class="n">Worker</span> <span class="n">can</span> <span class="n">drop</span> <span class="n">results</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="n">output</span> <span class="n">queue</span><span class="p">,</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">full</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">input_queue_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">output_queue_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">mandatory_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">supplementary_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">cuvis_worker_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">,</span> <span class="n">worker_settings</span><span class="p">);</span>

  <span class="n">cuvis_worker_set_acq_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">acqCont</span><span class="p">);</span>
  <span class="n">cuvis_worker_set_proc_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_worker_set_exporter</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">cube_exporter</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;registering signal for CTRL+c (cancel recording) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal_handler</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;recording...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_start</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>

  <span class="n">CUVIS_INT</span> <span class="n">used_queue</span><span class="p">;</span>
  <span class="n">CUVIS_INT</span> <span class="n">queue_limit</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!=</span> <span class="n">keepRunning</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_MESU</span> <span class="n">mesu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


    <span class="n">queue_limit</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">cuvis_worker_get_threads_busy</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">used_queue</span> <span class="o">==</span> <span class="n">queue_limit</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker queue is full! Main() loop can not keep up!&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">cuvis_acq_cont_queue_size_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="n">cuvis_acq_cont_queue_used_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">used_queue</span> <span class="o">==</span> <span class="n">queue_limit</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Acquisition queue is full! Worker can not keep up!&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">CUVIS_STATUS</span> <span class="n">ret</span><span class="p">;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">cuvis_worker_get_next_result</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">exposure_ms</span> <span class="o">+</span> <span class="mi">200</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">status_not_available</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker has no measurement ready yet...&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">status_ok</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker error, details: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cuvis_get_last_error_msg</span><span class="p">());</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">CUVIS_MESU_METADATA</span> <span class="n">mesu_data</span><span class="p">;</span>
      <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
      <span class="n">printf</span><span class="p">(</span>
          <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">current handle index: </span><span class="si">%04d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mesu_data</span><span class="o">.</span><span class="n">session_info_sequence_no</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mesu</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">SIG_DFL</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;cleaning up</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_stop</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_drop_all_queued</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  <span class="n">cuvis_worker_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">);</span>
  <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="n">cuvis_acq_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">acqCont</span><span class="p">);</span>
  <span class="n">cuvis_proc_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_calib_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">calib</span><span class="p">);</span>

  <span class="n">cuvis_shutdown</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;finished </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &quot;cuvis.hpp&quot;

#include &lt;cassert&gt;
#include &lt;chrono&gt;
#include &lt;cmath&gt;
#include &lt;csignal&gt;
#include &lt;ctime&gt;
#include &lt;iostream&gt;

using namespace std::literals::chrono_literals;

int keepRunning = 1;

void signal_handler(int sig)
{
  (void)sig;
  std::cout &lt;&lt; std::endl
            &lt;&lt; &quot;CTRL+C received. Stopping acquisiton...&quot; &lt;&lt; std::endl;
  keepRunning = 0;
}


int main(int argc, char* argv[])
{
  if (argc != 7)
  {
    std::cout &lt;&lt; std::endl &lt;&lt; &quot;Too few Arguments! Please provide:&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;user settings directory&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;factory directory&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;name of recording directory&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;exposure time in ms&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;auto exposure [1/0]&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;target fps&quot; &lt;&lt; std::endl;

    return -1;
  }

  char* userSettingsDir = argv[1];
  char* factoryDir = argv[2];
  char* recDir = argv[3];
  char* exposureString = argv[4];
  char* autoExpString = argv[5];
  char* fpsString = argv[6];

  int exposure_ms = std::stoi(exposureString);
  bool autoExp = std::stoi(autoExpString);
  double fps = std::stod(fpsString);

  std::cout &lt;&lt; &quot;Example 06 video cpp &quot; &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;User Settings Dir: &quot; &lt;&lt; userSettingsDir &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Factory Dir: &quot; &lt;&lt; factoryDir &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Recording Dir: &quot; &lt;&lt; recDir &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Exposure in ms: &quot; &lt;&lt; exposure_ms &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Auto Exposure: &quot; &lt;&lt; autoExp &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Target FPS: &quot; &lt;&lt; fps &lt;&lt; std::endl;

  std::cout &lt;&lt; &quot;loading user settings...&quot; &lt;&lt; std::endl;

  cuvis::General::init(userSettingsDir);

  //register log message output
  cuvis::General::register_log_callback(
      [](char const* msg, cuvis::loglevel_t lvl) -&gt; void {
        static std::map&lt;cuvis::loglevel_t, std::string&gt; log_prefix = {
            {loglevel_info, &quot;info: &quot;},
            {loglevel_warning, &quot;warning: &quot;},
            {loglevel_error, &quot;error: &quot;},
            {loglevel_fatal, &quot;fatal: &quot;}};

        std::cout &lt;&lt; &quot; - &quot; &lt;&lt; log_prefix.at(lvl) &lt;&lt; msg &lt;&lt; std::endl;
      },
      loglevel_info);

  std::cout &lt;&lt; &quot;loading calibration...&quot; &lt;&lt; std::endl;
  cuvis::Calibration calib(factoryDir);

  std::cout &lt;&lt; &quot;loading acquisition context...&quot; &lt;&lt; std::endl;
  cuvis::AcquisitionContext acq(calib);
  CUVIS_SESSION_INFO sess = {&quot;video&quot;, 0, 0};
  acq.set_session_info(sess);

  std::cout &lt;&lt; &quot;prepare saving of measurements...&quot; &lt;&lt; std::endl;
  cuvis::SaveArgs sargs;
  sargs.fps = fps;
  sargs.operation_mode = OperationMode_Internal;
  sargs.allow_overwrite = true;
  sargs.allow_session_file = true;
  sargs.export_dir = std::filesystem::path(recDir);

  std::cout &lt;&lt; &quot;Writing Files to: &quot; &lt;&lt; sargs.export_dir &lt;&lt; std::endl;
  cuvis::CubeExporter exporter(sargs);

  std::cout &lt;&lt; &quot;prepare processing of measurements...&quot; &lt;&lt; std::endl;
  cuvis::ProcessingContext proc(calib);
  cuvis::ProcessingArgs args;
  args.processing_mode = Cube_Raw;
  proc.set_processingArgs(args);

  std::cout &lt;&lt; &quot;waiting for camera to become online ...&quot;;
  acq.register_state_change_callback(
      [](cuvis::hardware_state_t state,
         std::map&lt;int, cuvis::AcquisitionContext::component_state_info_t&gt;
             comp_states) -&gt; void {
        std::cout &lt;&lt; std::endl;
        switch (state)
        {
          case hardware_state_online:
            std::cout &lt;&lt; &quot;camera online&quot; &lt;&lt; std::endl;
            break;

          case hardware_state_partially_online:
            std::cout &lt;&lt; &quot;camera partially online&quot; &lt;&lt; std::endl;
            break;

          case hardware_state_offline:
            std::cout &lt;&lt; &quot;camera offline&quot; &lt;&lt; std::endl;
            break;
        }

        std::cout &lt;&lt; &quot; components: &quot; &lt;&lt; std::endl;
        for (auto const&amp; comp : comp_states)
        {
          std::cout &lt;&lt; &quot; #&quot; &lt;&lt; comp.first &lt;&lt; &quot; &quot; &lt;&lt; comp.second.display_name
                    &lt;&lt; &quot; is &quot; &lt;&lt; (comp.second.is_online ? &quot;online&quot; : &quot;offline&quot;)
                    &lt;&lt; std::endl;
        }
      });

  while (acq.get_state() == hardware_state_offline)
  {
    std::this_thread::sleep_for(std::chrono::milliseconds(1000));
    std::cout &lt;&lt; &quot;.&quot;;
  }
  std::cout &lt;&lt; std::endl;

  std::cout &lt;&lt; &quot;initializing hardware...&quot; &lt;&lt; std::endl;
  acq.set_integration_time(exposure_ms).get();
  acq.set_operation_mode(OperationMode_Internal).get();
  acq.set_fps(fps).get();
  acq.set_auto_exp(autoExp);
  acq.set_continuous(true);

  std::cout &lt;&lt; &quot;registering signal for CTRL+c (cancel recording)...&quot;
            &lt;&lt; std::endl;
  std::signal(SIGINT, signal_handler);

  std::cout &lt;&lt; &quot;configuring worker...&quot; &lt;&lt; std::endl;
  cuvis::WorkerArgs worker_settings;
  worker_settings.can_skip_measurements = false; // Worker cannot skip exporting measurements
  worker_settings.can_skip_supplementary_steps = true; // Worker can skip view generation
  worker_settings.can_drop_results = true; // Worker can drop results from the output queue, if it is full
  worker_settings.input_queue_size = 10;
  worker_settings.output_queue_size = 5;
  worker_settings.mandatory_queue_size = 2;
  worker_settings.supplementary_queue_size = 2;

  cuvis::Worker worker(worker_settings);
  worker.set_acq_cont(&amp;acq);

  //comment out the following line to prevent processing
  worker.set_proc_cont(&amp;proc);

  //comment out the following line to prevent saving to disk
  worker.set_exporter(&amp;exporter);

  std::cout &lt;&lt; &quot;configuring FPS Analysis Stuff&quot; &lt;&lt; std::endl;
  using std::chrono::duration;
  using std::chrono::duration_cast;
  using std::chrono::high_resolution_clock;
  using std::chrono::milliseconds;
  auto t1 = high_resolution_clock::now();
  std::vector&lt;long long&gt; frametimes;
  int fpsAveraging = 200;

  std::cout &lt;&lt; &quot;recording...! &quot; &lt;&lt; std::endl;
  worker.start_processing();

  while (0 != keepRunning)
  {
    auto workerContainer = worker.get_next_result(100ms);
    // maybe we&#39;re already cancelling
    if (keepRunning == 0)
        continue;
    if (workerContainer.mesu.has_value())
    {
      auto t2 = t1;
      t1 = high_resolution_clock::now();

      std::cout
          &lt;&lt; &quot;current handle index: &quot;
          &lt;&lt; workerContainer.mesu.value().get_meta()-&gt;session_info.sequence_no
          &lt;&lt; std::endl;

      auto ms_int = duration_cast&lt;milliseconds&gt;(t1 - t2);

      if (frametimes.size() &gt;= fpsAveraging)
      {
        frametimes.erase(frametimes.begin());
      }
      frametimes.push_back(ms_int.count());
      long long totalFrametime = 0;
      for (int i = 0; i &lt; frametimes.size(); i++)
      {
        totalFrametime += frametimes[i];
      }
      double actualFps =
          1 / (((double)totalFrametime / (double)frametimes.size()) / 1000);
      if (abs(actualFps - fps) &gt; 0.5 &amp;&amp;
          frametimes.size() ==
              fpsAveraging) //fps is significantly different from user setting and averaging vector is full
      {
        std::cout &lt;&lt; &quot;WARNING: FPS was set to &quot; &lt;&lt; fps
                  &lt;&lt; &quot; but on average we only get &quot; &lt;&lt; actualFps &lt;&lt; std::endl;
      }
      if (worker.get_threads_busy() == 4)
      {
        std::cout &lt;&lt; &quot;worker queue is full! Main() loop can not keep up!&quot;
                  &lt;&lt; std::endl;
      }
      if (acq.get_queue_size() == acq.get_queue_used())
      {
        std::cout &lt;&lt; &quot;Acquisition queue is full! Worker can not keep up!&quot;
                  &lt;&lt; std::endl;
      }
    }
  }

  signal(SIGINT, SIG_DFL);
  std::cout &lt;&lt; &quot;acquisition stopped.&quot; &lt;&lt; std::endl;
  acq.set_continuous(false);
  acq.reset_state_change_callback();
  cuvis::General::shutdown();
  cuvis::General::reset_log_callback();
  std::cout &lt;&lt; std::endl &lt;&lt; &quot;finished.&quot; &lt;&lt; std::endl;
}
</pre></div>
</div>
</div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_recordVideo</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span>
                            <span class="n">factoryDir</span><span class="p">,</span>
                            <span class="n">recDir</span><span class="p">,</span>
                            <span class="n">exposure</span><span class="p">,</span>
                            <span class="n">autoExp</span><span class="p">,</span>
                            <span class="n">fps</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading calibration (factory)...&quot;</span><span class="p">)</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading acquisition context...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">AcquisitionContext</span><span class="p">(</span><span class="n">calibration</span><span class="p">)</span>
    <span class="n">session_info</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionData</span><span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">session_info</span> <span class="o">=</span> <span class="n">session_info</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prepare saving of measurements...&quot;</span><span class="p">)</span>
    <span class="n">saveArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SaveArgs</span><span class="p">(</span><span class="n">export_dir</span><span class="o">=</span><span class="n">recDir</span><span class="p">,</span>
                              <span class="n">allow_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">allow_session_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
                              <span class="n">operation_mode</span><span class="o">=</span><span class="n">cuvis</span><span class="o">.</span><span class="n">OperationMode</span><span class="o">.</span><span class="n">Software</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing files to: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">recDir</span><span class="p">))</span>
    <span class="n">cubeExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">CubeExporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prepare processing of measurements...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingContext</span><span class="p">(</span><span class="n">calibration</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Raw</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Waiting for camera to come online...&quot;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">HardwareState</span><span class="o">.</span><span class="n">Offline</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Component details:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">acquisitionContext</span><span class="o">.</span><span class="n">components</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Component #</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">comp</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">display_name</span><span class="p">,</span>
                                              <span class="s2">&quot;online&quot;</span> <span class="k">if</span> <span class="n">comp</span><span class="o">.</span><span class="n">online</span> <span class="k">else</span> <span class="s2">&quot;offline&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- info:        </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">sensor_info</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- use:         </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">user_field</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- pixelformat: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">pixel_format</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;initializing hardware...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="n">exposure</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">OperationMode</span><span class="o">.</span><span class="n">Internal</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">auto_exp</span> <span class="o">=</span> <span class="n">autoExp</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">set_continuous</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;configuring worker...&quot;</span><span class="p">)</span>
    <span class="n">workerSettings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">WorkerSettings</span><span class="p">()</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">Worker</span><span class="p">(</span><span class="n">workerSettings</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_acquisition_context</span><span class="p">(</span><span class="n">acquisitionContext</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_processing_context</span><span class="p">(</span><span class="n">processingContext</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_exporter</span><span class="p">(</span><span class="n">cubeExporter</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">start_processing</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;recording...! (will stop after 2 minutes)&quot;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">worker</span><span class="o">.</span><span class="n">has_next_result</span><span class="p">():</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>

        <span class="n">workerContainer</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">get_next_result</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># in ms</span>
        <span class="k">if</span> <span class="n">workerContainer</span><span class="o">.</span><span class="n">mesu</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;current handle index: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">workerContainer</span><span class="o">.</span><span class="n">mesu</span><span class="o">.</span><span class="n">session_info</span><span class="o">.</span><span class="n">sequence_number</span><span class="p">))</span>

            <span class="n">workerState</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">state</span>
            <span class="k">if</span> <span class="n">workerState</span><span class="o">.</span><span class="n">resultsInQueue</span> <span class="o">==</span> <span class="n">worker</span><span class="o">.</span><span class="n">output_queue_limit</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;worker output queue is full! Main() loop can not keep up!&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="k">if</span> <span class="n">workerState</span><span class="o">.</span><span class="n">measurementsInQueue</span> <span class="o">==</span> <span class="n">worker</span><span class="o">.</span><span class="n">mandatory_queue_limit</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisition queue is full! Worker can not keep up!&quot;</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisition stopped...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">set_continuous</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">stop_processing</span><span class="p">()</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>
    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">)</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default factory</span>
    <span class="n">loc_factory</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;factory&quot;</span>
    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX06_video&quot;</span>

    <span class="c1"># parameters</span>
    <span class="n">loc_exptime</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># in ms</span>
    <span class="n">loc_autoexp</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">loc_fps</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 06: Record video file. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">factoryDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Factory directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_factory</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">factoryDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">loc_factory</span>

    <span class="n">recDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of recording directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">recDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">recDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Exposure/Integration time in ms (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_exptime</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">exposure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">exposure</span> <span class="o">=</span> <span class="n">loc_exptime</span>
    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>

    <span class="n">autoExp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Auto-exposure time [True/False] (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_autoexp</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">autoExp</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">autoExp</span> <span class="o">=</span> <span class="n">loc_autoexp</span>
    <span class="n">autoExp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">autoExp</span><span class="p">)</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Target frames per second (fps) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_fps</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">fps</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="n">loc_fps</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

    <span class="n">run_example_recordVideo</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">recDir</span><span class="p">),</span> <span class="n">exposure</span><span class="p">,</span>
                            <span class="n">autoExp</span><span class="p">,</span> <span class="n">fps</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rerecording-a-video-from-already-recorded-data">
<h2>Rerecording a video from already recorded data<a class="headerlink" href="#rerecording-a-video-from-already-recorded-data" title="Link to this heading"></a></h2>
<p>This example demonstrates how to simulate recording a hyperspectral video sequence using data from a pre-existing session file. It replicates the process of live video recording without requiring an actual camera.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-Qw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-Qw==" name="Qw==" role="tab" tabindex="0">C</button><button aria-controls="panel-6-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-6-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-6-Qw==" class="sphinx-tabs-panel group-tab" id="panel-6-Qw==" name="Qw==" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;cuvis.h&quot;</span>

<span class="c1">#include &lt;signal.h&gt;</span>
<span class="c1">#include &lt;stdbool.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="c1">#ifdef WIN32</span>
  <span class="c1">#include &lt;Windows.h&gt;</span>
<span class="c1">#else</span>
  <span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#endif</span>

<span class="nb">int</span> <span class="n">keepRunning</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">void</span> <span class="n">signal_handler</span><span class="p">(</span><span class="nb">int</span> <span class="n">sig</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">signal received. Stopping acquisiton...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="n">sig</span><span class="p">;</span>
  <span class="n">keepRunning</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;To few Arguments! Please provide:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;user settings directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;sessionfile</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;name of recording directory</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;exposure time in ms</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;auto exposure [1/0]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;target fps</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">sessionfile</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">recDir</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">exposureString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="o">//</span><span class="ow">in</span> <span class="n">ms</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">autoExpString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
  <span class="n">char</span><span class="o">*</span> <span class="n">const</span> <span class="n">fpsString</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>

  <span class="nb">int</span> <span class="n">exposure_ms</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">exposureString</span><span class="p">);</span> <span class="o">//</span><span class="ow">in</span> <span class="n">ms</span>
  <span class="nb">bool</span> <span class="n">autoExp</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">atoi</span><span class="p">(</span><span class="n">autoExpString</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">autoExp</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">double</span> <span class="n">fps</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">fpsString</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Example 06 video&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">User Settings Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sessionfile: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">sessionfile</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recording Dir: &quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">recDir</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exposure in ms: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exposure_ms</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Auto Exposure: </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">autoExp</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Target FPS: </span><span class="si">%4.2f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_SESSION_FILE</span> <span class="n">sessFile</span><span class="p">;</span>
  <span class="n">CUVIS_ACQ_CONT</span> <span class="n">acqCont</span><span class="p">;</span>
  <span class="n">CUVIS_PROC_CONT</span> <span class="n">procCont</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading user settings...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span> <span class="n">loglevel_debug</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading session file... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_session_file_load</span><span class="p">(</span><span class="n">sessionfile</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sessFile</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;loading acquisition context... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_create_from_session_file</span><span class="p">(</span><span class="n">sessFile</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                                      <span class="o">&amp;</span><span class="n">acqCont</span><span class="p">));</span> <span class="o">//</span> <span class="n">simulating</span> <span class="o">=</span> <span class="n">true</span> <span class="o">--&gt;</span> <span class="n">use</span> <span class="n">frames</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sessionfile</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">real</span> <span class="n">camera</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;load processing context </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_create_from_session_file</span><span class="p">(</span><span class="n">sessFile</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">procCont</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;prepare saving of measurements... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_EXPORTER</span> <span class="n">cube_exporter</span><span class="p">;</span>

  <span class="n">CUVIS_EXPORT_GENERAL_SETTINGS</span> <span class="n">general_settings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">initializer</span> <span class="nb">list</span> <span class="n">only</span> <span class="n">takes</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="n">leave</span> <span class="n">empty</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">afterwards</span><span class="o">.</span>
      <span class="s2">&quot;all&quot;</span><span class="p">,</span>
      <span class="mi">1</span><span class="p">,</span>
      <span class="mf">0.0</span><span class="p">,</span>
      <span class="n">pan_sharpening_interpolation_type_NearestNeighbor</span><span class="p">,</span>
      <span class="n">pan_sharpening_algorithm_Noop</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">};</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">export_dir</span><span class="p">,</span> <span class="n">recDir</span><span class="p">);</span>

  <span class="n">CUVIS_EXPORT_CUBE_SETTINGS</span> <span class="n">cube_settings</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_fragmentation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_overwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_session_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">OperationMode_Internal</span><span class="p">;</span>
  <span class="n">cube_settings</span><span class="o">.</span><span class="n">allow_info_file</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_exporter_create_cube</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">,</span> <span class="n">general_settings</span><span class="p">,</span> <span class="n">cube_settings</span><span class="p">));</span>

  <span class="n">CUVIS_PROC_ARGS</span> <span class="n">procArgs</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">allow_recalib</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">procArgs</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">Cube_Raw</span><span class="p">;</span>

  <span class="n">CUVIS_SESSION_INFO</span> <span class="n">sess</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;video&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_set_session_info</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sess</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;waiting for simulated camera to become ready...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(;;)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_HARDWARE_STATE</span> <span class="n">state</span><span class="p">;</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_state</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">state</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">hardware_state_partially_online</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">camera partially online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="c1">#ifdef WIN32</span>
    <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">#else</span>
    <span class="n">usleep</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>
<span class="c1">#endif</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;component details:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_INT</span> <span class="n">compCount</span><span class="p">;</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_count</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">compCount</span><span class="p">));</span>
  <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">compIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">compIdx</span> <span class="o">&lt;</span> <span class="n">compCount</span><span class="p">;</span> <span class="n">compIdx</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_INT</span> <span class="n">online</span><span class="p">;</span>
    <span class="n">CUVIS_COMPONENT_INFO</span> <span class="n">cinfo</span><span class="p">;</span>

    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_get_component_info</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cinfo</span><span class="p">));</span>
    <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_comp_online_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">compIdx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">online</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; - component &#39;</span><span class="si">%s</span><span class="s2">&#39; is &quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">displayname</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">online</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;online</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;offline</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- info:        </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">sensorinfo</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- use:         </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">userfield</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot; -- pixelformat: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cinfo</span><span class="o">.</span><span class="n">pixelformat</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;initializing hardware...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_integration_time_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_operation_mode_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">OperationMode_Internal</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_fps_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="n">fps</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_queue_size_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_proc_cont_set_args</span><span class="p">(</span><span class="n">procCont</span><span class="p">,</span> <span class="n">procArgs</span><span class="p">));</span>

  <span class="n">cuvis_acq_cont_binning_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">CUVIS_WORKER</span> <span class="n">worker</span><span class="p">;</span>
  <span class="n">CUVIS_WORKER_SETTINGS</span> <span class="n">worker_settings</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_measurements</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>        <span class="o">//</span> <span class="n">Worker</span> <span class="n">cannot</span> <span class="n">skip</span> <span class="n">exporting</span> <span class="n">measurements</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_skip_supplementary_steps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">//</span> <span class="n">Worker</span> <span class="n">can</span> <span class="n">skip</span> <span class="n">view</span> <span class="n">generation</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">can_drop_results</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>             <span class="o">//</span> <span class="n">Worker</span> <span class="n">can</span> <span class="n">drop</span> <span class="n">results</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="n">output</span> <span class="n">queue</span><span class="p">,</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">full</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">input_queue_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">output_queue_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">mandatory_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">worker_settings</span><span class="o">.</span><span class="n">supplementary_queue_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">cuvis_worker_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">,</span> <span class="n">worker_settings</span><span class="p">);</span>

  <span class="n">cuvis_worker_set_acq_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">acqCont</span><span class="p">);</span>
  <span class="n">cuvis_worker_set_proc_cont</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_worker_set_exporter</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">cube_exporter</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;registering signal for CTRL+c (cancel recording) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal_handler</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;recording...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_start</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  

  <span class="n">CUVIS_INT</span> <span class="n">used_queue</span><span class="p">;</span>
  <span class="n">CUVIS_INT</span> <span class="n">queue_limit</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!=</span> <span class="n">keepRunning</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">CUVIS_MESU</span> <span class="n">mesu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">queue_limit</span> <span class="o">=</span> <span class="n">worker_settings</span><span class="o">.</span><span class="n">mandatory_queue_size</span> <span class="o">+</span> <span class="n">worker_settings</span><span class="o">.</span><span class="n">supplementary_queue_size</span><span class="p">;</span>
    <span class="n">cuvis_worker_get_threads_busy</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">used_queue</span> <span class="o">==</span> <span class="n">queue_limit</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker queue is full! Main() loop can not keep up!&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">cuvis_acq_cont_queue_size_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="n">cuvis_acq_cont_queue_used_get</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">used_queue</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">used_queue</span> <span class="o">==</span> <span class="n">queue_limit</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Acquisition queue is full! Worker can not keep up!&quot;</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">CUVIS_STATUS</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">cuvis_worker_get_next_result</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">status_not_available</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker has no measurement ready yet...&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">status_ok</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Worker error, details: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cuvis_get_last_error_msg</span><span class="p">());</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">mesu</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">CUVIS_MESU_METADATA</span> <span class="n">mesu_data</span><span class="p">;</span>
      <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_measurement_get_metadata</span><span class="p">(</span><span class="n">mesu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesu_data</span><span class="p">));</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">current handle index: </span><span class="si">%04d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mesu_data</span><span class="o">.</span><span class="n">session_info_sequence_no</span><span class="p">);</span>
      <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

      <span class="n">cuvis_measurement_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mesu</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">SIG_DFL</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;cleaning up</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_acq_cont_continuous_set</span><span class="p">(</span><span class="n">acqCont</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_stop</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  <span class="n">CUVIS_CHECK</span><span class="p">(</span><span class="n">cuvis_worker_drop_all_queued</span><span class="p">(</span><span class="n">worker</span><span class="p">));</span>
  <span class="n">cuvis_worker_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">worker</span><span class="p">);</span>
  <span class="n">cuvis_exporter_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cube_exporter</span><span class="p">);</span>
  <span class="n">cuvis_acq_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">acqCont</span><span class="p">);</span>
  <span class="n">cuvis_proc_cont_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">procCont</span><span class="p">);</span>
  <span class="n">cuvis_session_file_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sessFile</span><span class="p">);</span>

  <span class="n">cuvis_shutdown</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;finished </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Qysr" name="Qysr" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &quot;cuvis.hpp&quot;

#include &lt;cassert&gt;
#include &lt;chrono&gt;
#include &lt;cmath&gt;
#include &lt;csignal&gt;
#include &lt;ctime&gt;
#include &lt;iostream&gt;

using namespace std::literals::chrono_literals;

int keepRunning = 1;

void signal_handler(int sig)
{
  (void)sig;
  std::cout &lt;&lt; std::endl
            &lt;&lt; &quot;CTRL+C received. Stopping acquisiton...&quot; &lt;&lt; std::endl;
  keepRunning = 0;
}


int main(int argc, char* argv[])
{
  if (argc != 7)
  {
    std::cout &lt;&lt; std::endl &lt;&lt; &quot;To few Arguments! Please provide:&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;user settings directory&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;sessionfile&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;name of recording directory&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;exposure time in ms&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;auto exposure [1/0]&quot; &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;target fps&quot; &lt;&lt; std::endl;

    return -1;
  }

  char* userSettingsDir = argv[1];
  char* sessionfile = argv[2];
  char* recDir = argv[3];
  char* exposureString = argv[4];
  char* autoExpString = argv[5];
  char* fpsString = argv[6];

  int exposure_ms = std::stoi(exposureString);
  bool autoExp = std::stoi(autoExpString);
  double fps = std::stod(fpsString);

  std::cout &lt;&lt; &quot;Example 06 video cpp &quot; &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;User Settings Dir: &quot; &lt;&lt; userSettingsDir &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Sessionfile: &quot; &lt;&lt; sessionfile &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Recording Dir: &quot; &lt;&lt; recDir &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Exposure in ms: &quot; &lt;&lt; exposure_ms &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Auto Exposure: &quot; &lt;&lt; autoExp &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;Target FPS: &quot; &lt;&lt; fps &lt;&lt; std::endl;

  std::cout &lt;&lt; &quot;loading user settings...&quot; &lt;&lt; std::endl;

  cuvis::General::init(userSettingsDir);

  //register log message output
  cuvis::General::register_log_callback(
      [](char const* msg, cuvis::loglevel_t lvl) -&gt; void {
        static std::map&lt;cuvis::loglevel_t, std::string&gt; log_prefix = {
            {loglevel_info, &quot;info: &quot;},
            {loglevel_warning, &quot;warning: &quot;},
            {loglevel_error, &quot;error: &quot;},
            {loglevel_fatal, &quot;fatal: &quot;}};

        std::cout &lt;&lt; &quot; - &quot; &lt;&lt; log_prefix.at(lvl) &lt;&lt; msg &lt;&lt; std::endl;
      },
      loglevel_info);

  std::cout &lt;&lt; &quot;loading sessionfile...&quot; &lt;&lt; std::endl;
  cuvis::SessionFile sess(sessionfile);

  std::cout &lt;&lt; &quot;loading acquisition context...&quot; &lt;&lt; std::endl;
  cuvis::AcquisitionContext acq(
      sess,
      true); // simulating = true --&gt; use frames from sessionfile instead of real camera
  CUVIS_SESSION_INFO sessinfo = {&quot;video&quot;, 0, 0};
  acq.set_session_info(sessinfo);

  std::cout &lt;&lt; &quot;prepare saving of measurements...&quot; &lt;&lt; std::endl;
  cuvis::SaveArgs sargs;
  sargs.fps = fps;
  sargs.operation_mode = OperationMode_Internal;
  sargs.allow_overwrite = true;
  sargs.allow_session_file = true;
  sargs.export_dir = std::filesystem::path(recDir);

  std::cout &lt;&lt; &quot;Writing Files to: &quot; &lt;&lt; sargs.export_dir &lt;&lt; std::endl;
  cuvis::CubeExporter exporter(sargs);

  std::cout &lt;&lt; &quot;prepare processing of measurements...&quot; &lt;&lt; std::endl;
  cuvis::ProcessingContext proc(sess);
  cuvis::ProcessingArgs args;
  args.processing_mode = Cube_Raw;
  proc.set_processingArgs(args);

  std::cout &lt;&lt; &quot;waiting for camera to become online ...&quot;;
  acq.register_state_change_callback(
      [](cuvis::hardware_state_t state,
         std::map&lt;int, cuvis::AcquisitionContext::component_state_info_t&gt;
             comp_states) -&gt; void {
        std::cout &lt;&lt; std::endl;
        switch (state)
        {
          case hardware_state_online:
            std::cout &lt;&lt; &quot;camera online&quot; &lt;&lt; std::endl;
            break;

          case hardware_state_partially_online:
            std::cout &lt;&lt; &quot;camera partially online&quot; &lt;&lt; std::endl;
            break;

          case hardware_state_offline:
            std::cout &lt;&lt; &quot;camera offline&quot; &lt;&lt; std::endl;
            break;
        }

        std::cout &lt;&lt; &quot; components: &quot; &lt;&lt; std::endl;
        for (auto const&amp; comp : comp_states)
        {
          std::cout &lt;&lt; &quot; #&quot; &lt;&lt; comp.first &lt;&lt; &quot; &quot; &lt;&lt; comp.second.display_name
                    &lt;&lt; &quot; is &quot; &lt;&lt; (comp.second.is_online ? &quot;online&quot; : &quot;offline&quot;)
                    &lt;&lt; std::endl;
        }
      });

  while (acq.get_state() == hardware_state_offline)
  {
    std::this_thread::sleep_for(std::chrono::milliseconds(1000));
    std::cout &lt;&lt; &quot;.&quot;;
  }
  std::cout &lt;&lt; std::endl;

  std::cout &lt;&lt; &quot;initializing simulated hardware...&quot; &lt;&lt; std::endl;
  acq.set_integration_time(exposure_ms).get();
  acq.set_operation_mode(OperationMode_Internal).get();
  acq.set_fps(fps).get();
  acq.set_auto_exp(autoExp);
  acq.set_continuous(true);

  std::cout &lt;&lt; &quot;registering signal for CTRL+c (cancel recording)...&quot;
            &lt;&lt; std::endl;
  std::signal(SIGINT, signal_handler);

  std::cout &lt;&lt; &quot;configuring worker...&quot; &lt;&lt; std::endl;
  cuvis::WorkerArgs worker_settings;
  worker_settings.can_skip_measurements = false;       // Worker cannot skip exporting measurements
  worker_settings.can_skip_supplementary_steps = true; // Worker can skip view generation
  worker_settings.can_drop_results = true;             // Worker can drop results from the output queue, if it is full
  worker_settings.input_queue_size = 10;
  worker_settings.output_queue_size = 5;
  worker_settings.mandatory_queue_size = 2;
  worker_settings.supplementary_queue_size = 2;
  cuvis::Worker worker(worker_settings);
  worker.set_acq_cont(&amp;acq);

  //comment out the following line to prevent processing
  worker.set_proc_cont(&amp;proc);

  //comment out the following line to prevent saving to disk
  worker.set_exporter(&amp;exporter);

  std::cout &lt;&lt; &quot;configuring FPS Analysis Stuff&quot; &lt;&lt; std::endl;
  using std::chrono::duration;
  using std::chrono::duration_cast;
  using std::chrono::high_resolution_clock;
  using std::chrono::milliseconds;
  auto t1 = high_resolution_clock::now();
  std::vector&lt;long long&gt; frametimes;
  int fpsAveraging = 200;

  std::cout &lt;&lt; &quot;recording...! &quot; &lt;&lt; std::endl;
  worker.start_processing();

  while (keepRunning)
  {
    auto workerContainer = worker.get_next_result(100ms);
    if (workerContainer.mesu.has_value())
    {
      auto t2 = t1;
      t1 = high_resolution_clock::now();

      std::cout
          &lt;&lt; &quot;current handle index: &quot;
          &lt;&lt; workerContainer.mesu.value().get_meta()-&gt;session_info.sequence_no
          &lt;&lt; std::endl;

      auto ms_int = duration_cast&lt;milliseconds&gt;(t1 - t2);

      if (frametimes.size() &gt;= fpsAveraging)
      {
        frametimes.erase(frametimes.begin());
      }
      frametimes.push_back(ms_int.count());
      long long totalFrametime = 0;
      for (int i = 0; i &lt; frametimes.size(); i++)
      {
        totalFrametime += frametimes[i];
      }
      double actualFps =
          1 / (((double)totalFrametime / (double)frametimes.size()) / 1000);
      if (abs(actualFps - fps) &gt; 0.5 &amp;&amp;
          frametimes.size() ==
              fpsAveraging) //fps is significantly different from user setting and averaging vector is full
      {
        std::cout &lt;&lt; &quot;WARNING: FPS was set to &quot; &lt;&lt; fps
                  &lt;&lt; &quot; but on average we only get &quot; &lt;&lt; actualFps &lt;&lt; std::endl;
      }
      if (worker.get_threads_busy() == 4)
      {
        std::cout &lt;&lt; &quot;worker queue is full! Main() loop can not keep up!&quot;
                  &lt;&lt; std::endl;
      }
      if (acq.get_queue_size() == acq.get_queue_used())
      {
        std::cout &lt;&lt; &quot;Acquisition queue is full! Worker can not keep up!&quot;
                  &lt;&lt; std::endl;
      }
    }
  }

  signal(SIGINT, SIG_DFL);
  std::cout &lt;&lt; &quot;acquisition stopped.&quot; &lt;&lt; std::endl;
  acq.set_continuous(false);
  worker.stop_processing();
  worker.drop_all_queued();
  acq.reset_state_change_callback();
  cuvis::General::reset_log_callback();
  cuvis::General::shutdown();
  std::cout &lt;&lt; std::endl &lt;&lt; &quot;finished.&quot; &lt;&lt; std::endl;
}
</pre></div>
</div>
</div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><blockquote>
<div></div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuvis</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example_recordVideoFromSessionFile</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">,</span>
                                           <span class="n">measurementLoc</span><span class="p">,</span>
                                           <span class="n">recDir</span><span class="p">,</span>
                                           <span class="n">exposure</span><span class="p">,</span>
                                           <span class="n">autoExp</span><span class="p">,</span>
                                           <span class="n">fps</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading user settings...&quot;</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">)</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading session file ...&quot;</span><span class="p">)</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionFile</span><span class="p">(</span><span class="n">measurementLoc</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading acquisition context...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">AcquisitionContext</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">simulate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1">#</span>
    <span class="c1"># using images from session file instead of camera</span>
    <span class="n">session_info</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SessionData</span><span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">session_info</span> <span class="o">=</span> <span class="n">session_info</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prepare saving of measurements...&quot;</span><span class="p">)</span>
    <span class="n">saveArgs</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">SaveArgs</span><span class="p">(</span><span class="n">export_dir</span><span class="o">=</span><span class="n">recDir</span><span class="p">,</span>
                              <span class="n">allow_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">allow_session_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
                              <span class="n">operation_mode</span><span class="o">=</span><span class="n">cuvis</span><span class="o">.</span><span class="n">OperationMode</span><span class="o">.</span><span class="n">Internal</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing files to: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">recDir</span><span class="p">))</span>
    <span class="n">cubeExporter</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">CubeExporter</span><span class="p">(</span><span class="n">saveArgs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prepare processing of measurements...&quot;</span><span class="p">)</span>
    <span class="n">processingContext</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingContext</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
    <span class="n">processingContext</span><span class="o">.</span><span class="n">processing_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">ProcessingMode</span><span class="o">.</span><span class="n">Raw</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Waiting for camera to come online...&quot;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">HardwareState</span><span class="o">.</span><span class="n">Offline</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Component details:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Component details:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">is_online</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">acquisitionContext</span><span class="o">.</span><span class="n">components</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Component #</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">display_name</span><span class="p">,</span>
                                              <span class="s2">&quot;online&quot;</span> <span class="k">if</span> <span class="n">is_online</span> <span class="k">else</span> <span class="s2">&quot;offline&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- info:        </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">sensor_info</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- use:         </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">user_field</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- pixelformat: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">pixel_format</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;initializing simulated hardware...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="n">exposure</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">operation_mode</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">OperationMode</span><span class="o">.</span><span class="n">Internal</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">auto_exp</span> <span class="o">=</span> <span class="n">autoExp</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">set_continuous</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;configuring worker...&quot;</span><span class="p">)</span>
    <span class="n">workerSettings</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">WorkerSettings</span><span class="p">()</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="n">cuvis</span><span class="o">.</span><span class="n">Worker</span><span class="p">(</span><span class="n">workerSettings</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_acquisition_context</span><span class="p">(</span><span class="n">acquisitionContext</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_processing_context</span><span class="p">(</span><span class="n">processingContext</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">set_exporter</span><span class="p">(</span><span class="n">cubeExporter</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">start_processing</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;recording...! (will stop after 2 minutes)&quot;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">worker</span><span class="o">.</span><span class="n">has_next_result</span><span class="p">():</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>

        <span class="n">workerContainer</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">get_next_result</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">workerContainer</span><span class="o">.</span><span class="n">mesu</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;current handle index: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">workerContainer</span><span class="o">.</span><span class="n">mesu</span><span class="o">.</span><span class="n">session_info</span><span class="o">.</span><span class="n">sequence_number</span><span class="p">))</span>

            <span class="n">workerState</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">state</span>
            <span class="k">if</span> <span class="n">workerState</span><span class="o">.</span><span class="n">resultsInQueue</span> <span class="o">==</span> <span class="n">worker</span><span class="o">.</span><span class="n">output_queue_limit</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;worker output queue is full! Main() loop can not keep up!&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="k">if</span> <span class="n">workerState</span><span class="o">.</span><span class="n">measurementsInQueue</span> <span class="o">==</span> <span class="n">worker</span><span class="o">.</span><span class="n">mandatory_queue_limit</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisition queue is full! Worker can not keep up!&quot;</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisition stopped...&quot;</span><span class="p">)</span>
    <span class="n">acquisitionContext</span><span class="o">.</span><span class="n">set_continuous</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">stop_processing</span><span class="p">()</span>
    <span class="n">cuvis</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;finished.&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS&quot;</span><span class="p">))</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;sdk&quot;</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>
    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">lib_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUVIS_DATA&quot;</span><span class="p">)</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">lib_dir</span> <span class="o">/</span> \
            <span class="s2">&quot;sample_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;set_examples&quot;</span>

    <span class="c1"># default video</span>
    <span class="n">loc_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;set1_video&quot;</span> <span class="o">/</span> <span class="s2">&quot;video.cu3s&quot;</span>
    <span class="c1"># default settings</span>
    <span class="n">loc_settings</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">&quot;settings&quot;</span>

    <span class="c1"># default output</span>
    <span class="n">loc_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;EX07_video&quot;</span>

    <span class="c1"># parameters</span>
    <span class="n">loc_exptime</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># in ms</span>
    <span class="n">loc_autoexp</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">loc_fps</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 07: Record video from session file. Please provide:&quot;</span><span class="p">)</span>

    <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;User settings directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_settings</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">userSettingsDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">userSettingsDir</span> <span class="o">=</span> <span class="n">loc_settings</span>

    <span class="n">factoryDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Session file (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">loc_file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">factoryDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">factoryDir</span> <span class="o">=</span> <span class="n">loc_file</span>

    <span class="n">recDir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Name of recording directory (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_output</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">recDir</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">recDir</span> <span class="o">=</span> <span class="n">loc_output</span>

    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Exposure/Integration time in ms (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_exptime</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">exposure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">exposure</span> <span class="o">=</span> <span class="n">loc_exptime</span>
    <span class="n">exposure</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>

    <span class="n">autoExp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Auto-exposure time [True/False] (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_autoexp</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">autoExp</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">autoExp</span> <span class="o">=</span> <span class="n">loc_autoexp</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
        <span class="s2">&quot;Target frames per second (fps) (default: </span><span class="si">{}</span><span class="s2">): &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc_fps</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">fps</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="n">loc_fps</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

    <span class="n">run_example_recordVideoFromSessionFile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userSettingsDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">factoryDir</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">recDir</span><span class="p">),</span> <span class="n">exposure</span><span class="p">,</span>
                                           <span class="n">autoExp</span><span class="p">,</span> <span class="n">fps</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="releasehistory.html" class="btn btn-neutral float-left" title="v3.3.0" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cwrapper.html" class="btn btn-neutral float-right" title="Cuvis C API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Cubert GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>